(()=>{var B=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(a,c)=>(typeof require!="undefined"?require:a)[c]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var q=B("@wordpress/element");var j=B("@wordpress/element");var D=B("@wordpress/element"),S=()=>{let[e,a]=(0,D.useState)(()=>{let t=localStorage.getItem("fp_selected_client");return t?parseInt(t):null}),[c,n]=(0,D.useState)(null),[d,u]=(0,D.useState)(!1);(0,D.useEffect)(()=>{e?v(e):n(null)},[e]);let v=async t=>{u(!0);try{let h=await(await fetch(`/wp-json/fp-publisher/v1/clients/${t}`)).json();n(h)}catch(b){console.error("Failed to fetch client:",b),n(null)}finally{u(!1)}};return{selectedClientId:e,currentClient:c,loading:d,selectClient:t=>{a(t),t?localStorage.setItem("fp_selected_client",t.toString()):localStorage.removeItem("fp_selected_client")}}};var R=()=>{let{selectedClientId:e,currentClient:a}=S(),[c,n]=(0,j.useState)({scheduled:0,published_today:0,published_month:0,failed:0,total_accounts:0}),[d,u]=(0,j.useState)([]),[v,x]=(0,j.useState)(!0);(0,j.useEffect)(()=>{t()},[e]);let t=async()=>{x(!0);try{let r=new URLSearchParams;e&&r.set("client_id",e.toString());let[o,f,p,g]=await Promise.all([fetch(`/wp-json/fp-publisher/v1/jobs?${r}&status=pending`).then(l=>l.json()),fetch(`/wp-json/fp-publisher/v1/jobs?${r}&status=completed`).then(l=>l.json()),fetch(`/wp-json/fp-publisher/v1/jobs?${r}&status=failed`).then(l=>l.json()),e?fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts`).then(l=>l.json()):Promise.resolve({total:0})]);n({scheduled:o.total||0,published_today:0,published_month:f.total||0,failed:p.total||0,total_accounts:g.total||0});let i=await fetch(`/wp-json/fp-publisher/v1/jobs?${r}&limit=10`).then(l=>l.json());u(i.jobs||[])}catch(r){console.error("Failed to fetch dashboard data:",r)}finally{x(!1)}},b=r=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[r]||"\u{1F4F1}",h=r=>{let o={pending:{label:"Schedulato",class:"status-pending",icon:"\u23F1\uFE0F"},running:{label:"In corso",class:"status-running",icon:"\u25B6\uFE0F"},completed:{label:"Pubblicato",class:"status-completed",icon:"\u2705"},failed:{label:"Fallito",class:"status-failed",icon:"\u274C"}};return o[r]||o.pending},w=r=>{let o=new Date(r),p=new Date().getTime()-o.getTime(),g=Math.floor(p/6e4),i=Math.floor(g/60),l=Math.floor(i/24);return g<1?"Adesso":g<60?`${g} min fa`:i<24?`${i} ore fa`:l<7?`${l} giorni fa`:o.toLocaleDateString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})};return v?React.createElement("div",{className:"fp-dashboard loading"},React.createElement("div",{className:"loading-spinner"},"Caricamento dashboard...")):React.createElement("div",{className:"fp-dashboard"},React.createElement("div",{className:"dashboard-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F4CA} Dashboard"),a&&React.createElement("p",{className:"client-subtitle"},"Cliente: ",React.createElement("strong",null,a.name))),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"\u270F\uFE0F Nuovo Post"),React.createElement("button",{className:"button",onClick:t},"\u{1F504} Aggiorna"))),React.createElement("div",{className:"stats-grid"},React.createElement("div",{className:"stat-card scheduled"},React.createElement("div",{className:"stat-icon"},"\u23F1\uFE0F"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},c.scheduled),React.createElement("div",{className:"stat-label"},"Schedulati"))),React.createElement("div",{className:"stat-card published"},React.createElement("div",{className:"stat-icon"},"\u2705"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},c.published_month),React.createElement("div",{className:"stat-label"},"Pubblicati (mese)"))),React.createElement("div",{className:"stat-card failed"},React.createElement("div",{className:"stat-icon"},"\u274C"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},c.failed),React.createElement("div",{className:"stat-label"},"Falliti"))),React.createElement("div",{className:"stat-card accounts"},React.createElement("div",{className:"stat-icon"},"\u{1F4F1}"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},c.total_accounts),React.createElement("div",{className:"stat-label"},"Account Connessi")))),React.createElement("div",{className:"quick-actions"},React.createElement("h2",null,"\u26A1 Azioni Rapide"),React.createElement("div",{className:"actions-grid"},React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},React.createElement("span",{className:"action-icon"},"\u270F\uFE0F"),React.createElement("span",{className:"action-label"},"Componi Post")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-calendar"},React.createElement("span",{className:"action-icon"},"\u{1F4C5}"),React.createElement("span",{className:"action-label"},"Calendario")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-library"},React.createElement("span",{className:"action-icon"},"\u{1F5BC}\uFE0F"),React.createElement("span",{className:"action-label"},"Libreria Media")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-analytics"},React.createElement("span",{className:"action-icon"},"\u{1F4C8}"),React.createElement("span",{className:"action-label"},"Analytics")))),React.createElement("div",{className:"recent-activity"},React.createElement("div",{className:"section-header"},React.createElement("h2",null,"\u{1F552} Attivit\xE0 Recente"),React.createElement("a",{href:"/wp-admin/admin.php?page=fp-publisher-jobs",className:"view-all"},"Vedi tutti \u2192")),d.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessuna attivit\xE0 recente"),React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"Crea il tuo primo post")):React.createElement("div",{className:"activity-list"},d.map(r=>{var f,p,g,i;let o=h(r.status);return React.createElement("div",{key:r.id,className:"activity-item"},React.createElement("div",{className:"activity-icon"},b(r.channel)),React.createElement("div",{className:"activity-content"},React.createElement("div",{className:"activity-title"},((p=(f=r.payload)==null?void 0:f.message)==null?void 0:p.substring(0,60))||"Post senza titolo",((i=(g=r.payload)==null?void 0:g.message)==null?void 0:i.length)>60&&"..."),React.createElement("div",{className:"activity-meta"},React.createElement("span",{className:"channel-name"},r.channel),React.createElement("span",{className:"separator"},"\u2022"),React.createElement("span",{className:"time"},w(r.run_at)))),React.createElement("div",{className:"activity-status"},React.createElement("span",{className:`status-badge ${o.class}`},o.icon," ",o.label)))}))),a&&React.createElement("div",{className:"client-limits"},React.createElement("h2",null,"\u{1F4CA} Limiti Piano"),React.createElement("div",{className:"limits-grid"},React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Canali massimi:"),React.createElement("span",{className:"limit-value"},c.total_accounts," / ",a.limits.max_channels===Number.MAX_SAFE_INTEGER?"\u221E":a.limits.max_channels)),React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Post mensili:"),React.createElement("span",{className:"limit-value"},c.published_month," / ",a.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"\u221E":a.limits.max_posts_monthly)))))};var C=B("@wordpress/element");var $=()=>{var I;let{selectedClientId:e,currentClient:a}=S(),[c,n]=(0,C.useState)(""),[d,u]=(0,C.useState)([]),[v,x]=(0,C.useState)([]),[t,b]=(0,C.useState)([]),[h,w]=(0,C.useState)(""),[r,o]=(0,C.useState)(""),[f,p]=(0,C.useState)(!1);(0,C.useEffect)(()=>{e&&g()},[e]);let g=async()=>{var s;if(e)try{let _=await(await fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts`)).json(),E=[{id:"meta_facebook",name:"Facebook",icon:"\u{1F4D8}",connected:!1},{id:"meta_instagram",name:"Instagram",icon:"\u{1F4F7}",connected:!1},{id:"youtube",name:"YouTube",icon:"\u{1F4F9}",connected:!1},{id:"tiktok",name:"TikTok",icon:"\u{1F3B5}",connected:!1},{id:"google_business",name:"Google Business",icon:"\u{1F5FA}\uFE0F",connected:!1},{id:"wordpress_blog",name:"WordPress",icon:"\u{1F4DD}",connected:!0}];(s=_.accounts)==null||s.forEach(z=>{let L=E.find(X=>X.id===z.channel);L&&(L.connected=!0,L.accountName=z.account_name)}),x(E)}catch(m){console.error("Failed to fetch accounts:",m)}},i=s=>{u(m=>m.includes(s)?m.filter(_=>_!==s):[...m,s])},l=s=>{let m=s.target.files;m&&Array.from(m).forEach(_=>{let E=URL.createObjectURL(_),z=_.type.startsWith("image/")?"image":"video";b(L=>[...L,{url:E,type:z}])})},y=s=>{b(m=>m.filter((_,E)=>E!==s))},A=async(s=!1)=>{if(!e){alert("Seleziona un cliente prima di pubblicare");return}if(d.length===0){alert("Seleziona almeno un canale");return}if(!c.trim()){alert("Inserisci un messaggio");return}p(!0);try{let m=new Date().toISOString();h&&r&&(m=new Date(`${h}T${r}`).toISOString());let E=await(await fetch("/wp-json/fp-publisher/v1/publish/multi-channel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:e,channels:d,plan:{brand:(a==null?void 0:a.name)||"Brand",channels:d,slots:d.map(z=>({channel:z,scheduled_at:m})),template:{title:c.substring(0,100),content:c},status:s?"draft":"ready"},payload:{message:c,media:t.map(z=>({source:z.url,type:z.type}))},publish_at:m})})).json();E.success?(alert(`\u2705 ${s?"Bozza salvata":"Pubblicato"} con successo su ${E.published} canali!`),n(""),u([]),b([]),w(""),o(""),window.location.href="/wp-admin/admin.php?page=fp-publisher"):alert("\u274C Errore durante la pubblicazione")}catch(m){console.error("Publish failed:",m),alert("\u274C Errore durante la pubblicazione")}finally{p(!1)}},N=c.length,P=2200;return e?React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-header"},React.createElement("h1",null,"\u270F\uFE0F Componi Post"),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button",onClick:()=>A(!0),disabled:f},"\u{1F4BE} Salva Bozza"),React.createElement("button",{className:"button button-primary",onClick:()=>A(!1),disabled:f||d.length===0},f?"\u23F3 Pubblicando...":"\u{1F680} Pubblica"))),React.createElement("div",{className:"composer-layout"},React.createElement("div",{className:"composer-main"},React.createElement("div",{className:"message-editor"},React.createElement("textarea",{value:c,onChange:s=>n(s.target.value),placeholder:"Cosa vuoi condividere?",className:"message-textarea",rows:8}),React.createElement("div",{className:"editor-footer"},React.createElement("div",{className:"char-counter"},React.createElement("span",{className:N>P?"over-limit":""},N),React.createElement("span",{className:"separator"},"/"),React.createElement("span",null,P)),React.createElement("div",{className:"editor-tools"},React.createElement("button",{className:"tool-button",onClick:()=>{let s=prompt("Inserisci emoji:");s&&n(m=>m+s)},title:"Aggiungi emoji"},"\u{1F600}"),React.createElement("button",{className:"tool-button",onClick:()=>{let s=prompt("Inserisci hashtag (senza #):");s&&n(m=>m+" #"+s)},title:"Aggiungi hashtag"},"#\uFE0F\u20E3")))),React.createElement("div",{className:"media-section"},React.createElement("div",{className:"media-header"},React.createElement("h3",null,"\u{1F5BC}\uFE0F Media"),React.createElement("label",{className:"button button-small"},"\u{1F4E4} Carica Media",React.createElement("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:l,style:{display:"none"}}))),t.length>0&&React.createElement("div",{className:"media-grid"},t.map((s,m)=>React.createElement("div",{key:m,className:"media-item"},s.type==="image"?React.createElement("img",{src:s.url,alt:"Preview"}):React.createElement("video",{src:s.url,controls:!0}),React.createElement("button",{className:"remove-media",onClick:()=>y(m)},"\u2715"))))),React.createElement("div",{className:"scheduling-section"},React.createElement("h3",null,"\u23F0 Programmazione"),React.createElement("div",{className:"scheduling-inputs"},React.createElement("div",{className:"input-group"},React.createElement("label",null,"Data"),React.createElement("input",{type:"date",value:h,onChange:s=>w(s.target.value),min:new Date().toISOString().split("T")[0]})),React.createElement("div",{className:"input-group"},React.createElement("label",null,"Ora"),React.createElement("input",{type:"time",value:r,onChange:s=>o(s.target.value)})),h&&r&&React.createElement("button",{className:"button button-small",onClick:()=>{w(""),o("")}},"\u2715 Rimuovi")),!h&&!r&&React.createElement("p",{className:"scheduling-hint"},"\u{1F4A1} Lascia vuoto per pubblicare immediatamente"))),React.createElement("div",{className:"composer-sidebar"},React.createElement("div",{className:"channels-section"},React.createElement("h3",null,"\u{1F4F1} Canali di Pubblicazione"),React.createElement("p",{className:"channels-hint"},"Seleziona i canali dove pubblicare questo post"),React.createElement("div",{className:"channels-list"},v.map(s=>React.createElement("div",{key:s.id,className:`channel-item ${s.connected?"":"disabled"} ${d.includes(s.id)?"selected":""}`,onClick:()=>s.connected&&i(s.id)},React.createElement("div",{className:"channel-info"},React.createElement("span",{className:"channel-icon"},s.icon),React.createElement("div",{className:"channel-details"},React.createElement("div",{className:"channel-name"},s.name),s.accountName&&React.createElement("div",{className:"channel-account"},s.accountName),!s.connected&&React.createElement("div",{className:"channel-status"},"Non connesso"))),s.connected&&React.createElement("div",{className:"channel-checkbox"},React.createElement("input",{type:"checkbox",checked:d.includes(s.id),onChange:()=>{}}))))),d.length>0&&React.createElement("div",{className:"selected-count"},"\u2705 ",d.length," canale",d.length>1?"i":""," selezionat",d.length>1?"i":"o"),React.createElement("button",{className:"button button-full",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${e}`},"\u2699\uFE0F Gestisci Account")),c&&React.createElement("div",{className:"preview-section"},React.createElement("h3",null,"\u{1F441}\uFE0F Anteprima"),React.createElement("div",{className:"preview-card"},React.createElement("div",{className:"preview-header"},React.createElement("span",{className:"preview-avatar"},a!=null&&a.logo_url?React.createElement("img",{src:a.logo_url,alt:a.name}):React.createElement("span",{style:{backgroundColor:(a==null?void 0:a.color)||"#666"}},(I=a==null?void 0:a.name)==null?void 0:I.substring(0,2).toUpperCase())),React.createElement("div",{className:"preview-author"},React.createElement("div",{className:"preview-name"},a==null?void 0:a.name),React.createElement("div",{className:"preview-time"},"Adesso"))),React.createElement("div",{className:"preview-content"},c),t.length>0&&React.createElement("div",{className:"preview-media"},t[0].type==="image"?React.createElement("img",{src:t[0].url,alt:"Preview"}):React.createElement("video",{src:t[0].url}))))))):React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-empty"},React.createElement("h2",null,"\u26A0\uFE0F Nessun Cliente Selezionato"),React.createElement("p",null,"Seleziona un cliente dal menu in alto per iniziare a comporre")))};var M=B("@wordpress/element");var T=()=>{let{selectedClientId:e}=S(),[a,c]=(0,M.useState)(new Date),[n,d]=(0,M.useState)([]),[u,v]=(0,M.useState)("month");(0,M.useEffect)(()=>{e&&x()},[e,a]);let x=async()=>{if(e)try{let p=new URLSearchParams({client_id:e.toString()}),l=((await(await fetch(`/wp-json/fp-publisher/v1/jobs?${p}`)).json()).jobs||[]).map(y=>{var A,N,P;return{id:y.id,title:((N=(A=y.payload)==null?void 0:A.message)==null?void 0:N.substring(0,50))||"Post",channel:y.channel,date:y.run_at.split("T")[0],time:((P=y.run_at.split("T")[1])==null?void 0:P.substring(0,5))||"00:00",status:y.status}});d(l)}catch(p){console.error("Failed to fetch events:",p)}},t=()=>{let p=a.getFullYear(),g=a.getMonth();return new Date(p,g+1,0).getDate()},b=()=>{let p=a.getFullYear(),g=a.getMonth();return new Date(p,g,1).getDay()},h=p=>{let g=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(p).padStart(2,"0")}`;return n.filter(i=>i.date===g)},w=()=>{c(new Date(a.getFullYear(),a.getMonth()-1))},r=()=>{c(new Date(a.getFullYear(),a.getMonth()+1))},o=()=>{c(new Date)},f=()=>{let p=t(),g=b(),i=[];for(let l=0;l<g;l++)i.push(React.createElement("div",{key:`empty-${l}`,className:"calendar-day empty"}));for(let l=1;l<=p;l++){let y=h(l),A=new Date().toDateString()===new Date(a.getFullYear(),a.getMonth(),l).toDateString();i.push(React.createElement("div",{key:l,className:`calendar-day ${A?"today":""}`},React.createElement("div",{className:"day-number"},l),React.createElement("div",{className:"day-events"},y.slice(0,3).map(N=>React.createElement("div",{key:N.id,className:`event event-${N.status}`},React.createElement("span",{className:"event-time"},N.time),React.createElement("span",{className:"event-title"},N.title))),y.length>3&&React.createElement("div",{className:"event-more"},"+",y.length-3," altri"))))}return i};return React.createElement("div",{className:"fp-calendar"},React.createElement("div",{className:"calendar-header"},React.createElement("h1",null,"\u{1F4C5} Calendario Pubblicazioni"),React.createElement("div",{className:"calendar-controls"},React.createElement("button",{className:"button",onClick:w},"\u2190 Precedente"),React.createElement("button",{className:"button",onClick:o},"Oggi"),React.createElement("button",{className:"button",onClick:r},"Successivo \u2192"))),React.createElement("div",{className:"calendar-month-title"},a.toLocaleDateString("it-IT",{month:"long",year:"numeric"})),React.createElement("div",{className:"calendar-grid"},React.createElement("div",{className:"calendar-weekdays"},["Dom","Lun","Mar","Mer","Gio","Ven","Sab"].map(p=>React.createElement("div",{key:p,className:"weekday"},p))),React.createElement("div",{className:"calendar-days"},f())),React.createElement("div",{className:"calendar-legend"},React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot pending"}),React.createElement("span",null,"Schedulato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot completed"}),React.createElement("span",null,"Pubblicato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot failed"}),React.createElement("span",null,"Fallito"))))};var U=()=>{let{currentClient:e}=S();return React.createElement("div",{className:"fp-analytics"},React.createElement("h1",null,"\u{1F4C8} Analytics"),React.createElement("div",{className:"analytics-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4CA}"),React.createElement("h2",null,"Analytics in arrivo!"),React.createElement("p",null,"Questa sezione mostrer\xE0 statistiche dettagliate per"," ",e?e.name:"i tuoi clienti",":"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4CA} Performance post per canale"),React.createElement("li",null,"\u{1F4C8} Crescita follower nel tempo"),React.createElement("li",null,"\u{1F4AC} Engagement rate"),React.createElement("li",null,"\u{1F3AF} Migliori orari di pubblicazione"),React.createElement("li",null,"\u{1F4F1} Confronto canali"),React.createElement("li",null,"\u{1F4C5} Report mensili")),React.createElement("button",{className:"button button-primary"},"\u{1F680} Richiedi Demo Analytics")))};var O=()=>React.createElement("div",{className:"fp-media-library"},React.createElement("h1",null,"\u{1F5BC}\uFE0F Libreria Media"),React.createElement("div",{className:"library-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4C1}"),React.createElement("h2",null,"Libreria Media in arrivo!"),React.createElement("p",null,"Qui potrai gestire tutti i tuoi asset multimediali:"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4F7} Immagini"),React.createElement("li",null,"\u{1F3AC} Video"),React.createElement("li",null,"\u{1F3B5} Audio"),React.createElement("li",null,"\u{1F4C4} Documenti"),React.createElement("li",null,"\u{1F3F7}\uFE0F Tag e organizzazione"),React.createElement("li",null,"\u{1F50D} Ricerca avanzata")),React.createElement("button",{className:"button button-primary"},"\u{1F4E4} Carica i tuoi primi media")));var k=B("@wordpress/element"),G=()=>{let[e,a]=(0,k.useState)([]),[c,n]=(0,k.useState)(!0),[d,u]=(0,k.useState)(!1),[v,x]=(0,k.useState)(null),[t,b]=(0,k.useState)("");(0,k.useEffect)(()=>{h()},[]);let h=async()=>{n(!0);try{let l=await(await fetch("/wp-json/fp-publisher/v1/clients")).json();a(l.clients||[])}catch(i){console.error("Failed to fetch clients:",i)}finally{n(!1)}},w=()=>{x(null),u(!0)},r=i=>{x(i),u(!0)},o=async i=>{if(confirm(`Sei sicuro di voler eliminare il cliente "${i.name}"? Questa azione non pu\xF2 essere annullata.`))try{await fetch(`/wp-json/fp-publisher/v1/clients/${i.id}`,{method:"DELETE"}),h()}catch(l){console.error("Failed to delete client:",l),alert("Errore durante l'eliminazione del cliente")}},f=e.filter(i=>i.name.toLowerCase().includes(t.toLowerCase())||i.slug.toLowerCase().includes(t.toLowerCase())),p=i=>{let l={active:{label:"Attivo",class:"status-active",icon:"\u2705"},paused:{label:"Pausato",class:"status-paused",icon:"\u23F8\uFE0F"},archived:{label:"Archiviato",class:"status-archived",icon:"\u{1F4E6}"}};return l[i]||l.active},g=i=>{let l={free:{label:"Free",class:"plan-free"},basic:{label:"Basic",class:"plan-basic"},pro:{label:"Pro",class:"plan-pro"},agency:{label:"Agency",class:"plan-agency"},enterprise:{label:"Enterprise",class:"plan-enterprise"}};return l[i]||l.free};return React.createElement("div",{className:"fp-clients-management"},React.createElement("div",{className:"page-header"},React.createElement("h1",null,"\u{1F465} Gestione Clienti"),React.createElement("button",{className:"button button-primary",onClick:w},"+ Nuovo Cliente")),React.createElement("div",{className:"clients-toolbar"},React.createElement("div",{className:"search-box"},React.createElement("input",{type:"search",placeholder:"\u{1F50D} Cerca clienti...",value:t,onChange:i=>b(i.target.value)})),React.createElement("div",{className:"filters"})),c?React.createElement("div",{className:"loading-state"},"Caricamento clienti..."):f.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessun cliente trovato."),React.createElement("button",{className:"button button-primary",onClick:w},"Crea il tuo primo cliente")):React.createElement("div",{className:"clients-grid"},f.map(i=>{let l=p(i.status),y=g(i.billing_plan);return React.createElement("div",{key:i.id,className:"client-card"},React.createElement("div",{className:"client-card-header"},React.createElement("div",{className:"client-info"},i.logo_url?React.createElement("img",{src:i.logo_url,alt:i.name,className:"client-card-logo"}):React.createElement("span",{className:"client-card-badge",style:{backgroundColor:i.color}},i.name.substring(0,2).toUpperCase()),React.createElement("div",null,React.createElement("h3",null,i.name),React.createElement("span",{className:`status-badge ${l.class}`},l.icon," ",l.label)))),React.createElement("div",{className:"client-card-body"},React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4F1} Canali:"),React.createElement("span",{className:"stat-value"},i.limits.max_channels===Number.MAX_SAFE_INTEGER?"Illimitati":i.limits.max_channels)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4CA} Post/mese:"),React.createElement("span",{className:"stat-value"},i.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"Illimitati":i.limits.max_posts_monthly)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F465} Team:"),React.createElement("span",{className:"stat-value"},"Max ",i.limits.max_team_members===Number.MAX_SAFE_INTEGER?"Illimitati":i.limits.max_team_members)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4B0} Piano:"),React.createElement("span",{className:`plan-badge ${y.class}`},y.label))),React.createElement("div",{className:"client-card-footer"},React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher&client_id=${i.id}`},"Dashboard"),React.createElement("button",{className:"button button-small",onClick:()=>r(i)},"Modifica"),React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${i.id}`},"Account Social"),React.createElement("button",{className:"button button-small button-link-delete",onClick:()=>o(i)},"Elimina")))})),d&&React.createElement(H,{client:v,onClose:()=>{u(!1),x(null)},onSave:()=>{u(!1),x(null),h()}}))},H=({client:e,onClose:a,onSave:c})=>{let[n,d]=(0,k.useState)({name:(e==null?void 0:e.name)||"",slug:(e==null?void 0:e.slug)||"",logo_url:(e==null?void 0:e.logo_url)||"",website:(e==null?void 0:e.website)||"",industry:(e==null?void 0:e.industry)||"",timezone:(e==null?void 0:e.timezone)||"Europe/Rome",color:(e==null?void 0:e.color)||"#666666",status:(e==null?void 0:e.status)||"active"}),[u,v]=(0,k.useState)(!1);return React.createElement("div",{className:"fp-modal-overlay",onClick:a},React.createElement("div",{className:"fp-modal",onClick:t=>t.stopPropagation()},React.createElement("div",{className:"modal-header"},React.createElement("h2",null,e?"\u270F\uFE0F Modifica Cliente":"\u2795 Nuovo Cliente"),React.createElement("button",{className:"close-button",onClick:a},"\u2715")),React.createElement("form",{onSubmit:async t=>{t.preventDefault(),v(!0);try{let b=e?`/wp-json/fp-publisher/v1/clients/${e.id}`:"/wp-json/fp-publisher/v1/clients";await fetch(b,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),c()}catch(b){console.error("Failed to save client:",b),alert("Errore durante il salvataggio del cliente")}finally{v(!1)}}},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"name"},"Nome Cliente *"),React.createElement("input",{type:"text",id:"name",value:n.name,onChange:t=>d({...n,name:t.target.value}),required:!0})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"slug"},"Slug (URL-friendly)"),React.createElement("input",{type:"text",id:"slug",value:n.slug,onChange:t=>d({...n,slug:t.target.value}),placeholder:"Auto-generato dal nome"}),React.createElement("small",null,"Lascia vuoto per generazione automatica")),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"logo_url"},"URL Logo"),React.createElement("input",{type:"url",id:"logo_url",value:n.logo_url,onChange:t=>d({...n,logo_url:t.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"website"},"Sito Web"),React.createElement("input",{type:"url",id:"website",value:n.website,onChange:t=>d({...n,website:t.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"industry"},"Settore"),React.createElement("select",{id:"industry",value:n.industry,onChange:t=>d({...n,industry:t.target.value})},React.createElement("option",{value:""},"Seleziona settore"),React.createElement("option",{value:"technology"},"Technology"),React.createElement("option",{value:"food"},"Food & Beverage"),React.createElement("option",{value:"retail"},"Retail"),React.createElement("option",{value:"healthcare"},"Healthcare"),React.createElement("option",{value:"education"},"Education"),React.createElement("option",{value:"entertainment"},"Entertainment"),React.createElement("option",{value:"other"},"Altro"))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"timezone"},"Timezone"),React.createElement("select",{id:"timezone",value:n.timezone,onChange:t=>d({...n,timezone:t.target.value})},React.createElement("option",{value:"UTC"},"UTC"),React.createElement("option",{value:"Europe/Rome"},"Europe/Rome"),React.createElement("option",{value:"Europe/London"},"Europe/London"),React.createElement("option",{value:"America/New_York"},"America/New_York"),React.createElement("option",{value:"America/Los_Angeles"},"America/Los_Angeles")))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"color"},"Colore Brand"),React.createElement("div",{className:"color-picker"},React.createElement("input",{type:"color",id:"color",value:n.color,onChange:t=>d({...n,color:t.target.value})}),React.createElement("input",{type:"text",value:n.color,onChange:t=>d({...n,color:t.target.value}),placeholder:"#666666",pattern:"^#[0-9A-Fa-f]{6}$"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"billing_plan"},"Piano di Fatturazione"),React.createElement("select",{id:"billing_plan",value:n.billing_plan,onChange:t=>d({...n,billing_plan:t.target.value})},React.createElement("option",{value:"free"},"Free"),React.createElement("option",{value:"basic"},"Basic (\u20AC15/mese)"),React.createElement("option",{value:"pro"},"Pro (\u20AC29/mese)"),React.createElement("option",{value:"agency"},"Agency (\u20AC99/mese)"),React.createElement("option",{value:"enterprise"},"Enterprise (Custom)")))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Status"),React.createElement("div",{className:"radio-group"},React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"active",checked:n.status==="active",onChange:t=>d({...n,status:t.target.value})}),"Attivo"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"paused",checked:n.status==="paused",onChange:t=>d({...n,status:t.target.value})}),"Pausato"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"archived",checked:n.status==="archived",onChange:t=>d({...n,status:t.target.value})}),"Archiviato")))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"button",onClick:a,disabled:u},"Annulla"),e&&React.createElement("button",{type:"button",className:"button button-link-delete",onClick:()=>{handleDeleteClient(e),a()},disabled:u},"Elimina Cliente"),React.createElement("button",{type:"submit",className:"button button-primary",disabled:u},u?"Salvataggio...":"\u{1F4BE} Salva Modifiche")))))};var F=B("@wordpress/element"),Y=({onClientChange:e})=>{let[a,c]=(0,F.useState)([]),[n,d]=(0,F.useState)(()=>{let o=localStorage.getItem("fp_selected_client");return o?parseInt(o):null}),[u,v]=(0,F.useState)(!1),[x,t]=(0,F.useState)(!0),b=(0,F.useRef)(null);(0,F.useEffect)(()=>{h()},[]),(0,F.useEffect)(()=>{let o=f=>{b.current&&!b.current.contains(f.target)&&v(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);let h=async()=>{try{let f=await(await fetch("/wp-json/fp-publisher/v1/clients")).json();c(f.clients||[])}catch(o){console.error("Failed to fetch clients:",o)}finally{t(!1)}},w=o=>{d(o),v(!1),o?localStorage.setItem("fp_selected_client",o.toString()):localStorage.removeItem("fp_selected_client"),e&&e(o),window.location.reload()},r=a.find(o=>o.id===n);return x?React.createElement("div",{className:"fp-client-selector loading"},"Caricamento..."):React.createElement("div",{className:"fp-client-selector",ref:b},React.createElement("button",{className:"client-selector-button",onClick:()=>v(!u),"aria-expanded":u},React.createElement("div",{className:"selected-client"},r?React.createElement(React.Fragment,null,r.logo_url?React.createElement("img",{src:r.logo_url,alt:r.name,className:"client-logo"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:r.color}},r.name.substring(0,2).toUpperCase()),React.createElement("span",{className:"client-name"},r.name)):React.createElement(React.Fragment,null,React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",{className:"client-name"},"Tutti i clienti")),React.createElement("span",{className:"dropdown-icon"},u?"\u25B2":"\u25BC"))),u&&React.createElement("div",{className:"client-dropdown"},React.createElement("div",{className:`dropdown-item ${n?"":"active"}`,onClick:()=>w(null)},React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",null,"Tutti i clienti"),!n&&React.createElement("span",{className:"check-icon"},"\u2713")),React.createElement("div",{className:"dropdown-divider"}),a.filter(o=>o.status==="active").map(o=>React.createElement("div",{key:o.id,className:`dropdown-item ${n===o.id?"active":""}`,onClick:()=>w(o.id)},o.logo_url?React.createElement("img",{src:o.logo_url,alt:o.name,className:"client-avatar"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:o.color}},o.name.substring(0,2).toUpperCase()),React.createElement("span",null,o.name),n===o.id&&React.createElement("span",{className:"check-icon"},"\u2713"))),React.createElement("div",{className:"dropdown-divider"}),React.createElement("div",{className:"dropdown-item action-item",onClick:()=>{v(!1),window.location.href="/wp-admin/admin.php?page=fp-publisher-clients"}},React.createElement("span",{className:"icon"},"\u2699\uFE0F"),React.createElement("span",null,"Gestisci Clienti"))))};var J=()=>{let a=new URLSearchParams(window.location.search).get("page")||"fp-publisher";return React.createElement("div",{className:"fp-publisher-app"},React.createElement("div",{className:"fp-app-header"},React.createElement("div",{className:"app-logo"},React.createElement("span",{className:"logo-icon"},"\u{1F680}"),React.createElement("span",{className:"logo-text"},"FP Publisher")),React.createElement(Y,null)),React.createElement("div",{className:"fp-app-content"},(()=>{switch(a){case"fp-publisher":case"fp-publisher-dashboard":return React.createElement(R,null);case"fp-publisher-composer":return React.createElement($,null);case"fp-publisher-calendar":return React.createElement(T,null);case"fp-publisher-analytics":return React.createElement(U,null);case"fp-publisher-library":return React.createElement(O,null);case"fp-publisher-clients":return React.createElement(G,null);default:return React.createElement(R,null)}})()))};var Q=document.getElementById("fp-publisher-app");Q&&(0,q.render)(React.createElement(J,null),Q);})();
