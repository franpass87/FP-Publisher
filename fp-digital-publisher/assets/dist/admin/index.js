(()=>{var re=Object.create;var G=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty;var ue=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);var me=(e,i,p,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let l of ce(i))!pe.call(e,l)&&l!==p&&G(e,l,{get:()=>i[l],enumerable:!(s=le(i,l))||s.enumerable});return e};var P=(e,i,p)=>(p=e!=null?re(de(e)):{},me(i||!e||!e.__esModule?G(p,"default",{value:e,enumerable:!0}):p,e));var S=ue((he,Y)=>{Y.exports=window.wp.element});var oe=P(S());var j=P(S());var R=P(S()),z=()=>{let[e,i]=(0,R.useState)(()=>{let n=localStorage.getItem("fp_selected_client");if(n){let g=parseInt(n,10);return isNaN(g)?null:g}return null}),[p,s]=(0,R.useState)(null),[l,m]=(0,R.useState)(!1);(0,R.useEffect)(()=>{e?v(e):s(null)},[e]);let v=async n=>{m(!0);try{let g=await fetch(`/wp-json/fp-publisher/v1/clients/${n}`);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);let u=await g.json();s(u)}catch(g){console.error("Failed to fetch client:",g),s(null)}finally{m(!1)}};return{selectedClientId:e,currentClient:p,loading:l,selectClient:n=>{i(n);try{n?localStorage.setItem("fp_selected_client",n.toString()):localStorage.removeItem("fp_selected_client")}catch(g){console.warn("Failed to save client selection to localStorage:",g)}}}};var W=()=>{let{selectedClientId:e,currentClient:i}=z(),[p,s]=(0,j.useState)({scheduled:0,published_today:0,published_month:0,failed:0,total_accounts:0}),[l,m]=(0,j.useState)([]),[v,x]=(0,j.useState)(!0),n=(0,j.useCallback)(async()=>{x(!0);try{let c=new URLSearchParams;e&&c.set("client_id",e.toString());let[a,d,f,h]=await Promise.all([fetch(`/wp-json/fp-publisher/v1/jobs?${c}&status=pending`).then(async o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()}),fetch(`/wp-json/fp-publisher/v1/jobs?${c}&status=completed`).then(async o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()}),fetch(`/wp-json/fp-publisher/v1/jobs?${c}&status=failed`).then(async o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()}),e?fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts`).then(async o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()}):Promise.resolve({total:0})]);s({scheduled:a.total||0,published_today:0,published_month:d.total||0,failed:f.total||0,total_accounts:h.total||0});let t=await fetch(`/wp-json/fp-publisher/v1/jobs?${c}&limit=10`).then(async o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()});m(t.jobs||[])}catch(c){console.error("Failed to fetch dashboard data:",c)}finally{x(!1)}},[e]);(0,j.useEffect)(()=>{n()},[n]);let g=c=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[c]||"\u{1F4F1}",u=c=>{let a={pending:{label:"Schedulato",class:"status-pending",icon:"\u23F1\uFE0F"},running:{label:"In corso",class:"status-running",icon:"\u25B6\uFE0F"},completed:{label:"Pubblicato",class:"status-completed",icon:"\u2705"},failed:{label:"Fallito",class:"status-failed",icon:"\u274C"}};return a[c]||a.pending},b=c=>{let a=new Date(c),f=new Date().getTime()-a.getTime(),h=Math.floor(f/6e4),t=Math.floor(h/60),o=Math.floor(t/24);if(f<0){let N=Math.abs(h),w=Math.abs(t),C=Math.abs(o);if(N<1)return"Ora";if(N<60)return`Tra ${N} min`;if(w<24)return`Tra ${w} ore`;if(C<7)return`Tra ${C} giorni`}return h<1?"Adesso":h<60?`${h} min fa`:t<24?`${t} ore fa`:o<7?`${o} giorni fa`:a.toLocaleDateString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})};return v?React.createElement("div",{className:"fp-dashboard loading"},React.createElement("div",{className:"loading-spinner"},"Caricamento dashboard...")):React.createElement("div",{className:"fp-dashboard"},React.createElement("div",{className:"dashboard-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F4CA} Dashboard"),i&&React.createElement("p",{className:"client-subtitle"},"Cliente: ",React.createElement("strong",null,i.name))),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"\u270F\uFE0F Nuovo Post"),React.createElement("button",{className:"button",onClick:n},"\u{1F504} Aggiorna"))),React.createElement("div",{className:"stats-grid"},React.createElement("div",{className:"stat-card scheduled"},React.createElement("div",{className:"stat-icon"},"\u23F1\uFE0F"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},p.scheduled),React.createElement("div",{className:"stat-label"},"Schedulati"))),React.createElement("div",{className:"stat-card published"},React.createElement("div",{className:"stat-icon"},"\u2705"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},p.published_month),React.createElement("div",{className:"stat-label"},"Pubblicati (mese)"))),React.createElement("div",{className:"stat-card failed"},React.createElement("div",{className:"stat-icon"},"\u274C"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},p.failed),React.createElement("div",{className:"stat-label"},"Falliti"))),React.createElement("div",{className:"stat-card accounts"},React.createElement("div",{className:"stat-icon"},"\u{1F4F1}"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},p.total_accounts),React.createElement("div",{className:"stat-label"},"Account Connessi")))),React.createElement("div",{className:"quick-actions"},React.createElement("h2",null,"\u26A1 Azioni Rapide"),React.createElement("div",{className:"actions-grid"},React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},React.createElement("span",{className:"action-icon"},"\u270F\uFE0F"),React.createElement("span",{className:"action-label"},"Componi Post")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-calendar"},React.createElement("span",{className:"action-icon"},"\u{1F4C5}"),React.createElement("span",{className:"action-label"},"Calendario")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-library"},React.createElement("span",{className:"action-icon"},"\u{1F5BC}\uFE0F"),React.createElement("span",{className:"action-label"},"Libreria Media")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-analytics"},React.createElement("span",{className:"action-icon"},"\u{1F4C8}"),React.createElement("span",{className:"action-label"},"Analytics")))),React.createElement("div",{className:"recent-activity"},React.createElement("div",{className:"section-header"},React.createElement("h2",null,"\u{1F552} Attivit\xE0 Recente"),React.createElement("a",{href:"/wp-admin/admin.php?page=fp-publisher-jobs",className:"view-all"},"Vedi tutti \u2192")),l.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessuna attivit\xE0 recente"),React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"Crea il tuo primo post")):React.createElement("div",{className:"activity-list"},l.map(c=>{var d,f,h,t;let a=u(c.status);return React.createElement("div",{key:c.id,className:"activity-item"},React.createElement("div",{className:"activity-icon"},g(c.channel)),React.createElement("div",{className:"activity-content"},React.createElement("div",{className:"activity-title"},((f=(d=c.payload)==null?void 0:d.message)==null?void 0:f.substring(0,60))||"Post senza titolo",((t=(h=c.payload)==null?void 0:h.message)==null?void 0:t.length)>60&&"..."),React.createElement("div",{className:"activity-meta"},React.createElement("span",{className:"channel-name"},c.channel),React.createElement("span",{className:"separator"},"\u2022"),React.createElement("span",{className:"time"},b(c.run_at)))),React.createElement("div",{className:"activity-status"},React.createElement("span",{className:`status-badge ${a.class}`},a.icon," ",a.label)))}))),i&&React.createElement("div",{className:"client-limits"},React.createElement("h2",null,"\u{1F4CA} Limiti Piano"),React.createElement("div",{className:"limits-grid"},React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Canali massimi:"),React.createElement("span",{className:"limit-value"},p.total_accounts," / ",i.limits.max_channels===Number.MAX_SAFE_INTEGER?"\u221E":i.limits.max_channels)),React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Post mensili:"),React.createElement("span",{className:"limit-value"},p.published_month," / ",i.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"\u221E":i.limits.max_posts_monthly)))))};var A=P(S());var V=()=>{var I;let{selectedClientId:e,currentClient:i}=z(),[p,s]=(0,A.useState)(""),[l,m]=(0,A.useState)([]),[v,x]=(0,A.useState)([]),[n,g]=(0,A.useState)([]),[u,b]=(0,A.useState)(""),[c,a]=(0,A.useState)(""),[d,f]=(0,A.useState)(!1);(0,A.useEffect)(()=>{e&&h()},[e]),(0,A.useEffect)(()=>()=>{n.forEach(r=>{r.url.startsWith("blob:")&&URL.revokeObjectURL(r.url)})},[n]);let h=async()=>{var r;if(e)try{let y=await fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts`);if(!y.ok)throw new Error(`HTTP error! status: ${y.status}`);let _=await y.json(),E=[{id:"meta_facebook",name:"Facebook",icon:"\u{1F4D8}",connected:!1},{id:"meta_instagram",name:"Instagram",icon:"\u{1F4F7}",connected:!1},{id:"youtube",name:"YouTube",icon:"\u{1F4F9}",connected:!1},{id:"tiktok",name:"TikTok",icon:"\u{1F3B5}",connected:!1},{id:"google_business",name:"Google Business",icon:"\u{1F5FA}\uFE0F",connected:!1},{id:"wordpress_blog",name:"WordPress",icon:"\u{1F4DD}",connected:!0}],k=new Set(((r=_.accounts)==null?void 0:r.map(L=>L.channel))||[]),J=E.map(L=>{var H;let O=(H=_.accounts)==null?void 0:H.find(se=>se.channel===L.id);return O?{...L,connected:!0,accountName:O.account_name}:L});x(J)}catch(y){console.error("Failed to fetch accounts:",y)}},t=r=>{m(y=>y.includes(r)?y.filter(_=>_!==r):[...y,r])},o=r=>{let y=r.target.files;if(!y||y.length===0)return;let _=50*1024*1024,E=[];Array.from(y).forEach(k=>{if(k.size>_){E.push(`${k.name} (${(k.size/1024/1024).toFixed(2)}MB)`);return}if(!k.type.startsWith("image/")&&!k.type.startsWith("video/")){E.push(`${k.name} (tipo non supportato)`);return}let J=URL.createObjectURL(k),L=k.type.startsWith("image/")?"image":"video",O=`${Date.now()}-${Math.random().toString(36).substring(2,11)}`;g(H=>[...H,{id:O,url:J,type:L}])}),E.length>0&&alert(`File non validi:
${E.join(`
`)}

Dimensione massima: 50MB`),r.target.value=""},N=r=>{g(y=>{let _=y.find(E=>E.id===r);return _&&_.url.startsWith("blob:")&&URL.revokeObjectURL(_.url),y.filter(E=>E.id!==r)})},w=async(r=!1)=>{if(!d){if(!e){alert("Seleziona un cliente prima di pubblicare");return}if(l.length===0){alert("Seleziona almeno un canale");return}if(!p.trim()){alert("Inserisci un messaggio");return}f(!0);try{let y=new Date().toISOString();if(u&&c){let k=new Date(`${u}T${c}`);if(isNaN(k.getTime())){alert("\u274C Data o ora non valida"),f(!1);return}if(k<new Date){alert("\u274C La data di pubblicazione deve essere futura"),f(!1);return}y=k.toISOString()}let _=await fetch("/wp-json/fp-publisher/v1/publish/multi-channel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:e,channels:l,plan:{brand:(i==null?void 0:i.name)||"Brand",channels:l,slots:l.map(k=>({channel:k,scheduled_at:y})),template:{title:p.substring(0,100),content:p},status:r?"draft":"ready"},payload:{message:p,media:n.map(k=>({source:k.url,type:k.type}))},publish_at:y})});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);let E=await _.json();E.success?(alert(`\u2705 ${r?"Bozza salvata":"Pubblicato"} con successo su ${E.published} canali!`),n.forEach(k=>{k.url.startsWith("blob:")&&URL.revokeObjectURL(k.url)}),s(""),m([]),g([]),b(""),a(""),window.location.href="/wp-admin/admin.php?page=fp-publisher"):alert("\u274C Errore durante la pubblicazione")}catch(y){console.error("Publish failed:",y),alert("\u274C Errore durante la pubblicazione")}finally{f(!1)}}},C=p.length,B=2200;return e?React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-header"},React.createElement("h1",null,"\u270F\uFE0F Componi Post"),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button",onClick:()=>w(!0),disabled:d},"\u{1F4BE} Salva Bozza"),React.createElement("button",{className:"button button-primary",onClick:()=>w(!1),disabled:d||l.length===0},d?"\u23F3 Pubblicando...":"\u{1F680} Pubblica"))),React.createElement("div",{className:"composer-layout"},React.createElement("div",{className:"composer-main"},React.createElement("div",{className:"message-editor"},React.createElement("textarea",{value:p,onChange:r=>s(r.target.value),placeholder:"Cosa vuoi condividere?",className:"message-textarea",rows:8,"aria-label":"Messaggio del post",disabled:d,maxLength:B}),React.createElement("div",{className:"editor-footer"},React.createElement("div",{className:"char-counter"},React.createElement("span",{className:C>B?"over-limit":""},C),React.createElement("span",{className:"separator"},"/"),React.createElement("span",null,B)),React.createElement("div",{className:"editor-tools"},React.createElement("button",{className:"tool-button",onClick:()=>{let r=prompt("Inserisci emoji:");r&&s(y=>y+r)},title:"Aggiungi emoji"},"\u{1F600}"),React.createElement("button",{className:"tool-button",onClick:()=>{let r=prompt("Inserisci hashtag (senza #):");r&&s(y=>y+" #"+r)},title:"Aggiungi hashtag"},"#\uFE0F\u20E3")))),React.createElement("div",{className:"media-section"},React.createElement("div",{className:"media-header"},React.createElement("h3",null,"\u{1F5BC}\uFE0F Media"),React.createElement("label",{className:"button button-small"},"\u{1F4E4} Carica Media",React.createElement("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:o,style:{display:"none"}}))),n.length>0&&React.createElement("div",{className:"media-grid"},n.map(r=>React.createElement("div",{key:r.id,className:"media-item"},r.type==="image"?React.createElement("img",{src:r.url,alt:"Preview"}):React.createElement("video",{src:r.url,controls:!0}),React.createElement("button",{className:"remove-media",onClick:()=>N(r.id)},"\u2715"))))),React.createElement("div",{className:"scheduling-section"},React.createElement("h3",null,"\u23F0 Programmazione"),React.createElement("div",{className:"scheduling-inputs"},React.createElement("div",{className:"input-group"},React.createElement("label",{htmlFor:"scheduled-date"},"Data"),React.createElement("input",{id:"scheduled-date",type:"date",value:u,onChange:r=>b(r.target.value),min:new Date().toISOString().split("T")[0],disabled:d})),React.createElement("div",{className:"input-group"},React.createElement("label",{htmlFor:"scheduled-time"},"Ora"),React.createElement("input",{id:"scheduled-time",type:"time",value:c,onChange:r=>a(r.target.value),disabled:d})),u&&c&&React.createElement("button",{type:"button",className:"button button-small",onClick:()=>{b(""),a("")},disabled:d},"\u2715 Rimuovi")),!u&&!c&&React.createElement("p",{className:"scheduling-hint"},"\u{1F4A1} Lascia vuoto per pubblicare immediatamente"))),React.createElement("div",{className:"composer-sidebar"},React.createElement("div",{className:"channels-section"},React.createElement("h3",null,"\u{1F4F1} Canali di Pubblicazione"),React.createElement("p",{className:"channels-hint"},"Seleziona i canali dove pubblicare questo post"),React.createElement("div",{className:"channels-list"},v.map(r=>React.createElement("div",{key:r.id,className:`channel-item ${r.connected?"":"disabled"} ${l.includes(r.id)?"selected":""}`,onClick:()=>r.connected&&t(r.id)},React.createElement("div",{className:"channel-info"},React.createElement("span",{className:"channel-icon"},r.icon),React.createElement("div",{className:"channel-details"},React.createElement("div",{className:"channel-name"},r.name),r.accountName&&React.createElement("div",{className:"channel-account"},r.accountName),!r.connected&&React.createElement("div",{className:"channel-status"},"Non connesso"))),r.connected&&React.createElement("div",{className:"channel-checkbox"},React.createElement("input",{type:"checkbox",checked:l.includes(r.id),onChange:y=>y.stopPropagation(),readOnly:!0}))))),l.length>0&&React.createElement("div",{className:"selected-count"},"\u2705 ",l.length," canale",l.length>1?"i":""," selezionat",l.length>1?"i":"o"),React.createElement("button",{className:"button button-full",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${e}`},"\u2699\uFE0F Gestisci Account")),p&&React.createElement("div",{className:"preview-section"},React.createElement("h3",null,"\u{1F441}\uFE0F Anteprima"),React.createElement("div",{className:"preview-card"},React.createElement("div",{className:"preview-header"},React.createElement("span",{className:"preview-avatar"},i!=null&&i.logo_url?React.createElement("img",{src:i.logo_url,alt:i.name}):React.createElement("span",{style:{backgroundColor:(i==null?void 0:i.color)||"#666"}},(I=i==null?void 0:i.name)==null?void 0:I.substring(0,2).toUpperCase())),React.createElement("div",{className:"preview-author"},React.createElement("div",{className:"preview-name"},i==null?void 0:i.name),React.createElement("div",{className:"preview-time"},"Adesso"))),React.createElement("div",{className:"preview-content"},p),n.length>0&&n[0]&&React.createElement("div",{className:"preview-media"},n[0].type==="image"?React.createElement("img",{src:n[0].url,alt:"Preview"}):React.createElement("video",{src:n[0].url}))))))):React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-empty"},React.createElement("h2",null,"\u26A0\uFE0F Nessun Cliente Selezionato"),React.createElement("p",null,"Seleziona un cliente dal menu in alto per iniziare a comporre")))};var M=P(S());var q=()=>{let{selectedClientId:e}=z(),[i,p]=(0,M.useState)(new Date),[s,l]=(0,M.useState)([]),[m,v]=(0,M.useState)("month"),x=(0,M.useCallback)(async()=>{if(e)try{let f=new URLSearchParams({client_id:e.toString()}),h=await fetch(`/wp-json/fp-publisher/v1/jobs?${f}`);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);let o=((await h.json()).jobs||[]).filter(N=>N.run_at).map(N=>{var C,B,I;let w=N.run_at.split("T");return{id:N.id,title:((B=(C=N.payload)==null?void 0:C.message)==null?void 0:B.substring(0,50))||"Post",channel:N.channel,date:w[0]||"",time:((I=w[1])==null?void 0:I.substring(0,5))||"00:00",status:N.status}});l(o)}catch(f){console.error("Failed to fetch events:",f)}},[e]);(0,M.useEffect)(()=>{e&&x()},[e,i,x]);let n=()=>{let f=i.getFullYear(),h=i.getMonth();return new Date(f,h+1,0).getDate()},g=()=>{let f=i.getFullYear(),h=i.getMonth();return new Date(f,h,1).getDay()},u=f=>{let h=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(f).padStart(2,"0")}`;return s.filter(t=>t.date===h)},b=()=>{p(new Date(i.getFullYear(),i.getMonth()-1))},c=()=>{p(new Date(i.getFullYear(),i.getMonth()+1))},a=()=>{p(new Date)},d=()=>{let f=n(),h=g(),t=[];for(let w=0;w<h;w++)t.push(React.createElement("div",{key:`empty-${w}`,className:"calendar-day empty"}));let N=new Date().toDateString();for(let w=1;w<=f;w++){let C=u(w),B=new Date(i.getFullYear(),i.getMonth(),w),I=N===B.toDateString();t.push(React.createElement("div",{key:w,className:`calendar-day ${I?"today":""}`},React.createElement("div",{className:"day-number"},w),React.createElement("div",{className:"day-events"},C.slice(0,3).map(r=>React.createElement("div",{key:r.id,className:`event event-${r.status}`},React.createElement("span",{className:"event-time"},r.time),React.createElement("span",{className:"event-title"},r.title))),C.length>3&&React.createElement("div",{className:"event-more"},"+",C.length-3," altri"))))}return t};return React.createElement("div",{className:"fp-calendar"},React.createElement("div",{className:"calendar-header"},React.createElement("h1",null,"\u{1F4C5} Calendario Pubblicazioni"),React.createElement("div",{className:"calendar-controls"},React.createElement("button",{className:"button",onClick:b},"\u2190 Precedente"),React.createElement("button",{className:"button",onClick:a},"Oggi"),React.createElement("button",{className:"button",onClick:c},"Successivo \u2192"))),React.createElement("div",{className:"calendar-month-title"},i.toLocaleDateString("it-IT",{month:"long",year:"numeric"})),React.createElement("div",{className:"calendar-grid"},React.createElement("div",{className:"calendar-weekdays"},["Dom","Lun","Mar","Mer","Gio","Ven","Sab"].map(f=>React.createElement("div",{key:f,className:"weekday"},f))),React.createElement("div",{className:"calendar-days"},d())),React.createElement("div",{className:"calendar-legend"},React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot pending"}),React.createElement("span",null,"Schedulato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot completed"}),React.createElement("span",null,"Pubblicato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot failed"}),React.createElement("span",null,"Fallito"))))};var Q=()=>{let{currentClient:e}=z();return React.createElement("div",{className:"fp-analytics"},React.createElement("h1",null,"\u{1F4C8} Analytics"),React.createElement("div",{className:"analytics-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4CA}"),React.createElement("h2",null,"Analytics in arrivo!"),React.createElement("p",null,"Questa sezione mostrer\xE0 statistiche dettagliate per"," ",e?e.name:"i tuoi clienti",":"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4CA} Performance post per canale"),React.createElement("li",null,"\u{1F4C8} Crescita follower nel tempo"),React.createElement("li",null,"\u{1F4AC} Engagement rate"),React.createElement("li",null,"\u{1F3AF} Migliori orari di pubblicazione"),React.createElement("li",null,"\u{1F4F1} Confronto canali"),React.createElement("li",null,"\u{1F4C5} Report mensili")),React.createElement("button",{className:"button button-primary"},"\u{1F680} Richiedi Demo Analytics")))};var X=()=>React.createElement("div",{className:"fp-media-library"},React.createElement("h1",null,"\u{1F5BC}\uFE0F Libreria Media"),React.createElement("div",{className:"library-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4C1}"),React.createElement("h2",null,"Libreria Media in arrivo!"),React.createElement("p",null,"Qui potrai gestire tutti i tuoi asset multimediali:"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4F7} Immagini"),React.createElement("li",null,"\u{1F3AC} Video"),React.createElement("li",null,"\u{1F3B5} Audio"),React.createElement("li",null,"\u{1F4C4} Documenti"),React.createElement("li",null,"\u{1F3F7}\uFE0F Tag e organizzazione"),React.createElement("li",null,"\u{1F50D} Ricerca avanzata")),React.createElement("button",{className:"button button-primary"},"\u{1F4E4} Carica i tuoi primi media")));var F=P(S()),Z=()=>{let[e,i]=(0,F.useState)([]),[p,s]=(0,F.useState)(!0),[l,m]=(0,F.useState)(!1),[v,x]=(0,F.useState)(null),[n,g]=(0,F.useState)(""),u=(0,F.useCallback)(async()=>{s(!0);try{let t=await fetch("/wp-json/fp-publisher/v1/clients");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=await t.json();i(o.clients||[])}catch(t){console.error("Failed to fetch clients:",t)}finally{s(!1)}},[]);(0,F.useEffect)(()=>{u()},[u]);let b=()=>{x(null),m(!0)},c=t=>{x(t),m(!0)},a=async t=>{if(confirm(`Sei sicuro di voler eliminare il cliente "${t.name}"? Questa azione non pu\xF2 essere annullata.`))try{let o=await fetch(`/wp-json/fp-publisher/v1/clients/${t.id}`,{method:"DELETE"});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);u()}catch(o){console.error("Failed to delete client:",o),alert("Errore durante l'eliminazione del cliente")}},d=e.filter(t=>t.name.toLowerCase().includes(n.toLowerCase())||t.slug.toLowerCase().includes(n.toLowerCase())),f=t=>{let o={active:{label:"Attivo",class:"status-active",icon:"\u2705"},paused:{label:"Pausato",class:"status-paused",icon:"\u23F8\uFE0F"},archived:{label:"Archiviato",class:"status-archived",icon:"\u{1F4E6}"}};return o[t]||o.active},h=t=>{let o={free:{label:"Free",class:"plan-free"},basic:{label:"Basic",class:"plan-basic"},pro:{label:"Pro",class:"plan-pro"},agency:{label:"Agency",class:"plan-agency"},enterprise:{label:"Enterprise",class:"plan-enterprise"}};return o[t]||o.free};return React.createElement("div",{className:"fp-clients-management"},React.createElement("div",{className:"page-header"},React.createElement("h1",null,"\u{1F465} Gestione Clienti"),React.createElement("button",{className:"button button-primary",onClick:b},"+ Nuovo Cliente")),React.createElement("div",{className:"clients-toolbar"},React.createElement("div",{className:"search-box"},React.createElement("input",{type:"search",placeholder:"\u{1F50D} Cerca clienti...",value:n,onChange:t=>g(t.target.value)})),React.createElement("div",{className:"filters"})),p?React.createElement("div",{className:"loading-state"},"Caricamento clienti..."):d.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessun cliente trovato."),React.createElement("button",{className:"button button-primary",onClick:b},"Crea il tuo primo cliente")):React.createElement("div",{className:"clients-grid"},d.map(t=>{let o=f(t.status),N=h(t.billing_plan);return React.createElement("div",{key:t.id,className:"client-card"},React.createElement("div",{className:"client-card-header"},React.createElement("div",{className:"client-info"},t.logo_url?React.createElement("img",{src:t.logo_url,alt:t.name,className:"client-card-logo"}):React.createElement("span",{className:"client-card-badge",style:{backgroundColor:t.color}},t.name.substring(0,2).toUpperCase()),React.createElement("div",null,React.createElement("h3",null,t.name),React.createElement("span",{className:`status-badge ${o.class}`},o.icon," ",o.label)))),React.createElement("div",{className:"client-card-body"},React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4F1} Canali:"),React.createElement("span",{className:"stat-value"},t.limits.max_channels===Number.MAX_SAFE_INTEGER?"Illimitati":t.limits.max_channels)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4CA} Post/mese:"),React.createElement("span",{className:"stat-value"},t.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"Illimitati":t.limits.max_posts_monthly)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F465} Team:"),React.createElement("span",{className:"stat-value"},"Max ",t.limits.max_team_members===Number.MAX_SAFE_INTEGER?"Illimitati":t.limits.max_team_members)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4B0} Piano:"),React.createElement("span",{className:`plan-badge ${N.class}`},N.label))),React.createElement("div",{className:"client-card-footer"},React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher&client_id=${t.id}`},"Dashboard"),React.createElement("button",{className:"button button-small",onClick:()=>c(t)},"Modifica"),React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${t.id}`},"Account Social"),React.createElement("button",{className:"button button-small button-link-delete",onClick:()=>a(t)},"Elimina")))})),l&&React.createElement(ge,{client:v,onClose:()=>{m(!1),x(null)},onSave:()=>{m(!1),x(null),u()}}))},ge=({client:e,onClose:i,onSave:p})=>{let[s,l]=(0,F.useState)({name:(e==null?void 0:e.name)||"",slug:(e==null?void 0:e.slug)||"",logo_url:(e==null?void 0:e.logo_url)||"",website:(e==null?void 0:e.website)||"",industry:(e==null?void 0:e.industry)||"",timezone:(e==null?void 0:e.timezone)||"Europe/Rome",color:(e==null?void 0:e.color)||"#666666",status:(e==null?void 0:e.status)||"active"}),[m,v]=(0,F.useState)(!1);return(0,F.useEffect)(()=>{e&&l({name:e.name||"",slug:e.slug||"",logo_url:e.logo_url||"",website:e.website||"",industry:e.industry||"",timezone:e.timezone||"Europe/Rome",color:e.color||"#666666",status:e.status||"active"})},[e]),React.createElement("div",{className:"fp-modal-overlay",onClick:i},React.createElement("div",{className:"fp-modal",onClick:n=>n.stopPropagation()},React.createElement("div",{className:"modal-header"},React.createElement("h2",null,e?"\u270F\uFE0F Modifica Cliente":"\u2795 Nuovo Cliente"),React.createElement("button",{className:"close-button",onClick:i},"\u2715")),React.createElement("form",{onSubmit:async n=>{n.preventDefault(),v(!0);try{let g=e?`/wp-json/fp-publisher/v1/clients/${e.id}`:"/wp-json/fp-publisher/v1/clients",b=await fetch(g,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);p(),i()}catch(g){console.error("Failed to save client:",g),alert("Errore durante il salvataggio del cliente")}finally{v(!1)}}},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"name"},"Nome Cliente *"),React.createElement("input",{type:"text",id:"name",value:s.name,onChange:n=>l({...s,name:n.target.value}),required:!0})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"slug"},"Slug (URL-friendly)"),React.createElement("input",{type:"text",id:"slug",value:s.slug,onChange:n=>l({...s,slug:n.target.value}),placeholder:"Auto-generato dal nome"}),React.createElement("small",null,"Lascia vuoto per generazione automatica")),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"logo_url"},"URL Logo"),React.createElement("input",{type:"url",id:"logo_url",value:s.logo_url,onChange:n=>l({...s,logo_url:n.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"website"},"Sito Web"),React.createElement("input",{type:"url",id:"website",value:s.website,onChange:n=>l({...s,website:n.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"industry"},"Settore"),React.createElement("select",{id:"industry",value:s.industry,onChange:n=>l({...s,industry:n.target.value})},React.createElement("option",{value:""},"Seleziona settore"),React.createElement("option",{value:"technology"},"Technology"),React.createElement("option",{value:"food"},"Food & Beverage"),React.createElement("option",{value:"retail"},"Retail"),React.createElement("option",{value:"healthcare"},"Healthcare"),React.createElement("option",{value:"education"},"Education"),React.createElement("option",{value:"entertainment"},"Entertainment"),React.createElement("option",{value:"other"},"Altro"))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"timezone"},"Timezone"),React.createElement("select",{id:"timezone",value:s.timezone,onChange:n=>l({...s,timezone:n.target.value})},React.createElement("option",{value:"UTC"},"UTC"),React.createElement("option",{value:"Europe/Rome"},"Europe/Rome"),React.createElement("option",{value:"Europe/London"},"Europe/London"),React.createElement("option",{value:"America/New_York"},"America/New_York"),React.createElement("option",{value:"America/Los_Angeles"},"America/Los_Angeles")))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"color"},"Colore Brand"),React.createElement("div",{className:"color-picker"},React.createElement("input",{type:"color",id:"color",value:s.color,onChange:n=>l({...s,color:n.target.value})}),React.createElement("input",{type:"text",value:s.color,onChange:n=>l({...s,color:n.target.value}),placeholder:"#666666",pattern:"^#[0-9A-Fa-f]{6}$"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"billing_plan"},"Piano di Fatturazione"),React.createElement("select",{id:"billing_plan",value:s.billing_plan,onChange:n=>l({...s,billing_plan:n.target.value})},React.createElement("option",{value:"free"},"Free"),React.createElement("option",{value:"basic"},"Basic (\u20AC15/mese)"),React.createElement("option",{value:"pro"},"Pro (\u20AC29/mese)"),React.createElement("option",{value:"agency"},"Agency (\u20AC99/mese)"),React.createElement("option",{value:"enterprise"},"Enterprise (Custom)")))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Status"),React.createElement("div",{className:"radio-group"},React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"active",checked:s.status==="active",onChange:n=>l({...s,status:n.target.value})}),"Attivo"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"paused",checked:s.status==="paused",onChange:n=>l({...s,status:n.target.value})}),"Pausato"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"archived",checked:s.status==="archived",onChange:n=>l({...s,status:n.target.value})}),"Archiviato")))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"button",onClick:i,disabled:m},"Annulla"),e&&React.createElement("button",{type:"button",className:"button button-link-delete",onClick:()=>{handleDeleteClient(e),i()},disabled:m},"Elimina Cliente"),React.createElement("button",{type:"submit",className:"button button-primary",disabled:m},m?"Salvataggio...":"\u{1F4BE} Salva Modifiche")))))};var U=P(S());var K=()=>{let{selectedClientId:e,currentClient:i}=z(),[p,s]=(0,U.useState)([]),[l,m]=(0,U.useState)(!0),v=(0,U.useCallback)(async()=>{if(e){m(!0);try{let a=await fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let d=await a.json();s(d.accounts||[])}catch(a){console.error("Failed to fetch accounts:",a)}finally{m(!1)}}},[e]);(0,U.useEffect)(()=>{e&&v()},[e,v]);let x=a=>{alert(`Connessione OAuth per ${a} - Implementare flow OAuth 2.0`)},n=async a=>{if(e&&confirm("Vuoi davvero disconnettere questo account?"))try{let d=await fetch(`/wp-json/fp-publisher/v1/clients/${e}/accounts/${a}`,{method:"DELETE"});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);v()}catch(d){console.error("Failed to disconnect account:",d),alert("Errore durante la disconnessione")}},g=a=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[a]||"\u{1F4F1}",u=a=>({meta_facebook:"Facebook",meta_instagram:"Instagram",youtube:"YouTube",tiktok:"TikTok",google_business:"Google Business",wordpress_blog:"WordPress Blog"})[a]||a,b=[{id:"meta_facebook",name:"Facebook",icon:"\u{1F4D8}",oauth:!0},{id:"meta_instagram",name:"Instagram",icon:"\u{1F4F7}",oauth:!0},{id:"youtube",name:"YouTube",icon:"\u{1F4F9}",oauth:!0},{id:"tiktok",name:"TikTok",icon:"\u{1F3B5}",oauth:!0},{id:"google_business",name:"Google Business",icon:"\u{1F5FA}\uFE0F",oauth:!0},{id:"wordpress_blog",name:"WordPress Blog",icon:"\u{1F4DD}",oauth:!1}],c=a=>p.some(d=>d.channel===a&&d.status==="active");return e?React.createElement("div",{className:"fp-social-accounts"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F50C} Account Social"),i&&React.createElement("p",{className:"subtitle"},"Cliente: ",React.createElement("strong",null,i.name))),React.createElement("button",{className:"button",onClick:v},"\u{1F504} Aggiorna")),l?React.createElement("div",{className:"loading-spinner"},"Caricamento account..."):React.createElement(React.Fragment,null,p.length>0&&React.createElement("div",{className:"section"},React.createElement("h2",null,"\u2705 Account Connessi (",p.length,")"),React.createElement("div",{className:"accounts-grid"},p.map(a=>React.createElement("div",{key:a.id,className:"account-card connected"},React.createElement("div",{className:"account-icon"},g(a.channel)),React.createElement("div",{className:"account-info"},React.createElement("h3",null,u(a.channel)),React.createElement("p",{className:"account-name"},a.account_name),React.createElement("p",{className:"account-meta"},"Connesso il ",new Date(a.connected_at).toLocaleDateString("it-IT"))),React.createElement("div",{className:"account-actions"},React.createElement("span",{className:"status-badge active"},"\u2713 Attivo"),React.createElement("button",{className:"button button-link-delete",onClick:()=>n(a.id)},"Disconnetti")))))),React.createElement("div",{className:"section"},React.createElement("h2",null,"\u2795 Connetti Nuovo Account"),React.createElement("div",{className:"channels-grid"},b.map(a=>{let d=c(a.id);return React.createElement("div",{key:a.id,className:`channel-card ${d?"disabled":""}`},React.createElement("div",{className:"channel-icon"},a.icon),React.createElement("h3",null,a.name),a.oauth&&React.createElement("p",{className:"channel-meta"},"OAuth 2.0"),d?React.createElement("button",{className:"button",disabled:!0},"\u2713 Connesso"):React.createElement("button",{className:"button button-primary",onClick:()=>x(a.id)},"+ Connetti"))}))),React.createElement("div",{className:"section help-section"},React.createElement("h3",null,"\u2139\uFE0F Come Connettere Account"),React.createElement("ol",null,React.createElement("li",null,'Click su "',React.createElement("strong",null,"+ Connetti"),'" per il canale desiderato'),React.createElement("li",null,"Segui il flusso OAuth 2.0 (login + autorizzazione)"),React.createElement("li",null,`Una volta connesso, l'account apparir\xE0 in "Account Connessi"`),React.createElement("li",null,"Potrai usarlo nel Composer per pubblicare contenuti")),React.createElement("div",{className:"info-box"},React.createElement("strong",null,"\u{1F4A1} Nota:")," WordPress Blog non richiede OAuth perch\xE9 pubblichi direttamente sul tuo sito WordPress locale.")))):React.createElement("div",{className:"fp-social-accounts"},React.createElement("div",{className:"empty-state"},React.createElement("h2",null,"\u{1F50C} Account Social"),React.createElement("p",null,"Seleziona un cliente dal dropdown in alto per gestire gli account social.")))};var T=P(S());var ee=()=>{let{selectedClientId:e}=z(),[i,p]=(0,T.useState)([]),[s,l]=(0,T.useState)(!0),[m,v]=(0,T.useState)("all"),[x,n]=(0,T.useState)(1),[g,u]=(0,T.useState)(0),b=20,c=(0,T.useCallback)(async()=>{l(!0);try{let t=new URLSearchParams;e&&t.set("client_id",e.toString()),m!=="all"&&t.set("status",m),t.set("limit",b.toString()),t.set("offset",((x-1)*b).toString());let o=await fetch(`/wp-json/fp-publisher/v1/jobs?${t}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let N=await o.json();p(N.jobs||[]),u(N.total||0)}catch(t){console.error("Failed to fetch jobs:",t)}finally{l(!1)}},[e,m,x,b]);(0,T.useEffect)(()=>{c()},[c]);let a=t=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[t]||"\u{1F4F1}",d=t=>{let o={pending:{label:"In attesa",class:"status-pending",icon:"\u23F1\uFE0F"},running:{label:"In esecuzione",class:"status-running",icon:"\u25B6\uFE0F"},completed:{label:"Completato",class:"status-completed",icon:"\u2705"},failed:{label:"Fallito",class:"status-failed",icon:"\u274C"}};return o[t]||o.pending},f=t=>new Date(t).toLocaleString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}),h=b>0?Math.ceil(g/b):1;return React.createElement("div",{className:"fp-jobs"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F4CB} Cronologia Job"),React.createElement("p",{className:"subtitle"},"Visualizza lo stato di tutti i job di pubblicazione")),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button",onClick:c},"\u{1F504} Aggiorna"))),React.createElement("div",{className:"filters"},React.createElement("div",{className:"filter-group"},React.createElement("label",null,"Filtra per stato:"),React.createElement("select",{value:m,onChange:t=>{v(t.target.value),n(1)}},React.createElement("option",{value:"all"},"Tutti"),React.createElement("option",{value:"pending"},"In attesa"),React.createElement("option",{value:"running"},"In esecuzione"),React.createElement("option",{value:"completed"},"Completati"),React.createElement("option",{value:"failed"},"Falliti"))),React.createElement("div",{className:"stats-inline"},React.createElement("span",null,"Totale job: ",React.createElement("strong",null,g)),h>1&&React.createElement("span",null,"Pagina ",React.createElement("strong",null,x)," di ",React.createElement("strong",null,h)))),s?React.createElement("div",{className:"loading-spinner"},"Caricamento job..."):i.length===0?React.createElement("div",{className:"empty-state"},React.createElement("h2",null,"\u{1F4ED} Nessun Job Trovato"),React.createElement("p",null,"Non ci sono job ",m!=="all"?`con stato "${m}"`:"in questo momento","."),React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"\u270F\uFE0F Crea Nuovo Post")):React.createElement(React.Fragment,null,React.createElement("div",{className:"jobs-table"},React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"ID"),React.createElement("th",null,"Canale"),React.createElement("th",null,"Messaggio"),React.createElement("th",null,"Stato"),React.createElement("th",null,"Programmato per"),React.createElement("th",null,"Tentativi"),React.createElement("th",null,"Azioni"))),React.createElement("tbody",null,i.map(t=>{var N,w,C;let o=d(t.status);return React.createElement("tr",{key:t.id},React.createElement("td",null,"#",t.id),React.createElement("td",null,React.createElement("span",{className:"channel-badge"},a(t.channel)," ",t.channel)),React.createElement("td",{className:"message-cell"},((w=(N=t.payload)==null?void 0:N.message)==null?void 0:w.substring(0,50))||"N/A",((C=t.payload)==null?void 0:C.message)&&t.payload.message.length>50&&"..."),React.createElement("td",null,React.createElement("span",{className:`status-badge ${o.class}`},o.icon," ",o.label)),React.createElement("td",null,f(t.run_at)),React.createElement("td",null,React.createElement("span",{className:t.attempts>1?"text-warning":""},t.attempts)),React.createElement("td",null,React.createElement("button",{className:"button button-small",onClick:()=>alert(`Job #${t.id}

Dettagli:
${JSON.stringify(t,null,2)}`)},"\u{1F441}\uFE0F Dettagli")))})))),h>1&&React.createElement("div",{className:"pagination"},React.createElement("button",{className:"button",disabled:x===1,onClick:()=>n(x-1)},"\u2190 Precedente"),React.createElement("span",{className:"page-info"},"Pagina ",x," di ",h),React.createElement("button",{className:"button",disabled:x===h,onClick:()=>n(x+1)},"Successiva \u2192")),React.createElement("div",{className:"legend"},React.createElement("h3",null,"Legenda Stati"),React.createElement("ul",null,React.createElement("li",null,React.createElement("span",{className:"status-badge status-pending"},"\u23F1\uFE0F In attesa")," - Job programmato, in attesa di esecuzione"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-running"},"\u25B6\uFE0F In esecuzione")," - Worker sta processando il job"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-completed"},"\u2705 Completato")," - Pubblicato con successo"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-failed"},"\u274C Fallito")," - Errore durante la pubblicazione")))))};var $=P(S()),te=()=>{var n,g;let[e,i]=(0,$.useState)({worker_enabled:!0,worker_interval:60,max_retries:3,retry_backoff:300,circuit_breaker_enabled:!0,circuit_breaker_threshold:5,metrics_enabled:!0}),[p,s]=(0,$.useState)(!1),[l,m]=(0,$.useState)(!1),v=(0,$.useRef)(null);(0,$.useEffect)(()=>()=>{v.current&&clearTimeout(v.current)},[]);let x=async()=>{s(!0),m(!1),v.current&&(clearTimeout(v.current),v.current=null);try{await new Promise(u=>setTimeout(u,1e3)),m(!0),v.current=window.setTimeout(()=>{m(!1),v.current=null},3e3)}catch(u){console.error("Failed to save settings:",u),alert("Errore durante il salvataggio delle impostazioni")}finally{s(!1)}};return React.createElement("div",{className:"fp-settings"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u2699\uFE0F Impostazioni"),React.createElement("p",{className:"subtitle"},"Configura il comportamento del plugin"))),React.createElement("div",{className:"settings-container"},React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F504} Worker Queue"),React.createElement("p",{className:"section-description"},"Il worker processa i job di pubblicazione in background usando WP-Cron."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:e.worker_enabled,onChange:u=>i({...e,worker_enabled:u.target.checked})}),React.createElement("strong",null,"Abilita Worker")),React.createElement("p",{className:"setting-description"},"Se disabilitato, i job non verranno processati automaticamente.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Intervallo Worker (secondi)")),React.createElement("input",{type:"number",min:"30",max:"600",value:e.worker_interval,onChange:u=>{let b=parseInt(u.target.value,10);isNaN(b)||i({...e,worker_interval:b})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Ogni quanti secondi il worker controlla nuovi job da processare (min: 30, max: 600)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F501} Retry Logic"),React.createElement("p",{className:"section-description"},"Configura come gestire i job falliti."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Tentativi Massimi")),React.createElement("input",{type:"number",min:"1",max:"10",value:e.max_retries,onChange:u=>{let b=parseInt(u.target.value,10);isNaN(b)||i({...e,max_retries:b})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Quante volte riprovare un job fallito prima di spostarlo nel Dead Letter Queue.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Backoff Esponenziale (secondi)")),React.createElement("input",{type:"number",min:"60",max:"3600",value:e.retry_backoff,onChange:u=>{let b=parseInt(u.target.value,10);isNaN(b)||i({...e,retry_backoff:b})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Tempo base tra un tentativo e l'altro. Viene moltiplicato esponenzialmente (60 \u2192 120 \u2192 240)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F6E1}\uFE0F Circuit Breaker"),React.createElement("p",{className:"section-description"},"Protegge da cascading failures quando un'API \xE8 down."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:e.circuit_breaker_enabled,onChange:u=>i({...e,circuit_breaker_enabled:u.target.checked})}),React.createElement("strong",null,"Abilita Circuit Breaker")),React.createElement("p",{className:"setting-description"},"Se un canale fallisce ripetutamente, viene temporaneamente disabilitato.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Soglia Fallimenti")),React.createElement("input",{type:"number",min:"3",max:"20",value:e.circuit_breaker_threshold,onChange:u=>{let b=parseInt(u.target.value,10);isNaN(b)||i({...e,circuit_breaker_threshold:b})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Dopo quanti fallimenti consecutivi aprire il circuit breaker."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F4CA} Monitoring & Metrics"),React.createElement("p",{className:"section-description"},"Raccogli metriche per monitorare le performance del sistema."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:e.metrics_enabled,onChange:u=>i({...e,metrics_enabled:u.target.checked})}),React.createElement("strong",null,"Abilita Metriche")),React.createElement("p",{className:"setting-description"},"Traccia job processati, errori, tempi di esecuzione (formato Prometheus-ready)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u2139\uFE0F Informazioni Sistema"),React.createElement("div",{className:"info-grid"},React.createElement("div",{className:"info-item"},React.createElement("strong",null,"PHP Version:"),React.createElement("span",null,((n=window.fpPublisher)==null?void 0:n.phpVersion)||"N/A")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"WordPress Version:"),React.createElement("span",null,((g=window.fpPublisher)==null?void 0:g.wpVersion)||"N/A")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"Plugin Version:"),React.createElement("span",null,"0.2.0")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"WP-Cron Status:"),React.createElement("span",{className:"status-badge status-completed"},"\u2713 Attivo")))),React.createElement("div",{className:"settings-actions"},React.createElement("button",{className:"button button-primary button-large",onClick:x,disabled:p},p?"\u{1F4BE} Salvataggio...":"\u{1F4BE} Salva Impostazioni"),l&&React.createElement("span",{className:"save-notice"},"\u2705 Impostazioni salvate con successo!")),React.createElement("div",{className:"settings-help"},React.createElement("h3",null,"\u{1F4A1} Suggerimenti"),React.createElement("ul",null,React.createElement("li",null,React.createElement("strong",null,"Worker Interval:")," Un valore basso (30s) significa pubblicazione pi\xF9 rapida ma pi\xF9 carico server."),React.createElement("li",null,React.createElement("strong",null,"Max Retries:")," Aumenta se hai API instabili, diminuisci per fallire velocemente."),React.createElement("li",null,React.createElement("strong",null,"Circuit Breaker:")," Utile in produzione per evitare sprechi quando un'API \xE8 completamente down."),React.createElement("li",null,React.createElement("strong",null,"Metrics:")," Consigliato per production, aiuta a debuggare problemi.")))))};var D=P(S()),ae=({onClientChange:e})=>{let[i,p]=(0,D.useState)([]),[s,l]=(0,D.useState)(()=>{let a=localStorage.getItem("fp_selected_client");if(a){let d=parseInt(a,10);return isNaN(d)?null:d}return null}),[m,v]=(0,D.useState)(!1),[x,n]=(0,D.useState)(!0),g=(0,D.useRef)(null);(0,D.useEffect)(()=>{u()},[]),(0,D.useEffect)(()=>{let a=d=>{g.current&&!g.current.contains(d.target)&&v(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let u=async()=>{try{let a=await fetch("/wp-json/fp-publisher/v1/clients");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let d=await a.json();p(d.clients||[])}catch(a){console.error("Failed to fetch clients:",a)}finally{n(!1)}},b=a=>{l(a),v(!1);try{a?localStorage.setItem("fp_selected_client",a.toString()):localStorage.removeItem("fp_selected_client")}catch(d){console.warn("Failed to save client selection to localStorage:",d)}e&&e(a),window.location.replace(window.location.href)},c=i.find(a=>a.id===s);return x?React.createElement("div",{className:"fp-client-selector loading"},"Caricamento..."):React.createElement("div",{className:"fp-client-selector",ref:g},React.createElement("button",{className:"client-selector-button",onClick:()=>v(!m),"aria-expanded":m},React.createElement("div",{className:"selected-client"},c?React.createElement(React.Fragment,null,c.logo_url?React.createElement("img",{src:c.logo_url,alt:c.name,className:"client-logo"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:c.color}},c.name.substring(0,2).toUpperCase()),React.createElement("span",{className:"client-name"},c.name)):React.createElement(React.Fragment,null,React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",{className:"client-name"},"Tutti i clienti")),React.createElement("span",{className:"dropdown-icon"},m?"\u25B2":"\u25BC"))),m&&React.createElement("div",{className:"client-dropdown"},React.createElement("div",{className:`dropdown-item ${s?"":"active"}`,onClick:()=>b(null)},React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",null,"Tutti i clienti"),!s&&React.createElement("span",{className:"check-icon"},"\u2713")),React.createElement("div",{className:"dropdown-divider"}),i.filter(a=>a.status==="active").map(a=>React.createElement("div",{key:a.id,className:`dropdown-item ${s===a.id?"active":""}`,onClick:()=>b(a.id)},a.logo_url?React.createElement("img",{src:a.logo_url,alt:a.name,className:"client-avatar"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:a.color}},a.name.substring(0,2).toUpperCase()),React.createElement("span",null,a.name),s===a.id&&React.createElement("span",{className:"check-icon"},"\u2713"))),React.createElement("div",{className:"dropdown-divider"}),React.createElement("div",{className:"dropdown-item action-item",onClick:()=>{v(!1),window.location.href="/wp-admin/admin.php?page=fp-publisher-clients"}},React.createElement("span",{className:"icon"},"\u2699\uFE0F"),React.createElement("span",null,"Gestisci Clienti"))))};var ie=()=>{let i=new URLSearchParams(window.location.search).get("page")||"fp-publisher";return React.createElement("div",{className:"fp-publisher-app"},React.createElement("div",{className:"fp-app-header"},React.createElement("div",{className:"app-logo"},React.createElement("span",{className:"logo-icon"},"\u{1F680}"),React.createElement("span",{className:"logo-text"},"FP Publisher")),React.createElement(ae,null)),React.createElement("div",{className:"fp-app-content"},(()=>{switch(i){case"fp-publisher":case"fp-publisher-dashboard":return React.createElement(W,null);case"fp-publisher-composer":return React.createElement(V,null);case"fp-publisher-calendar":return React.createElement(q,null);case"fp-publisher-analytics":return React.createElement(Q,null);case"fp-publisher-library":return React.createElement(X,null);case"fp-publisher-clients":return React.createElement(Z,null);case"fp-publisher-accounts":return React.createElement(K,null);case"fp-publisher-jobs":return React.createElement(ee,null);case"fp-publisher-settings":return React.createElement(te,null);default:return React.createElement(W,null)}})()))};var ne=document.getElementById("fp-publisher-app");ne&&(0,oe.render)(React.createElement(ie,null),ne);})();
