(()=>{var A=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(n,u)=>(typeof require!="undefined"?require:n)[u]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var ae=A("@wordpress/element");var j=A("@wordpress/element");var L=A("@wordpress/element"),z=()=>{let[t,n]=(0,L.useState)(()=>{let o=localStorage.getItem("fp_selected_client");if(o){let b=parseInt(o,10);return isNaN(b)?null:b}return null}),[u,r]=(0,L.useState)(null),[p,m]=(0,L.useState)(!1);(0,L.useEffect)(()=>{t?y(t):r(null)},[t]);let y=async o=>{m(!0);try{let b=await fetch(`/wp-json/fp-publisher/v1/clients/${o}`);if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);let g=await b.json();r(g)}catch(b){console.error("Failed to fetch client:",b),r(null)}finally{m(!1)}};return{selectedClientId:t,currentClient:u,loading:p,selectClient:o=>{n(o);try{o?localStorage.setItem("fp_selected_client",o.toString()):localStorage.removeItem("fp_selected_client")}catch(b){console.warn("Failed to save client selection to localStorage:",b)}}}};var W=()=>{let{selectedClientId:t,currentClient:n}=z(),[u,r]=(0,j.useState)({scheduled:0,published_today:0,published_month:0,failed:0,total_accounts:0}),[p,m]=(0,j.useState)([]),[y,h]=(0,j.useState)(!0),o=(0,j.useCallback)(async()=>{h(!0);try{let d=new URLSearchParams;t&&d.set("client_id",t.toString());let[a,c,v,s]=await Promise.all([fetch(`/wp-json/fp-publisher/v1/jobs?${d}&status=pending`).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}),fetch(`/wp-json/fp-publisher/v1/jobs?${d}&status=completed`).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}),fetch(`/wp-json/fp-publisher/v1/jobs?${d}&status=failed`).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}),t?fetch(`/wp-json/fp-publisher/v1/clients/${t}/accounts`).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}):Promise.resolve({total:0})]);r({scheduled:a.total||0,published_today:0,published_month:c.total||0,failed:v.total||0,total_accounts:s.total||0});let e=await fetch(`/wp-json/fp-publisher/v1/jobs?${d}&limit=10`).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()});m(e.jobs||[])}catch(d){console.error("Failed to fetch dashboard data:",d)}finally{h(!1)}},[t]);(0,j.useEffect)(()=>{o()},[o]);let b=d=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[d]||"\u{1F4F1}",g=d=>{let a={pending:{label:"Schedulato",class:"status-pending",icon:"\u23F1\uFE0F"},running:{label:"In corso",class:"status-running",icon:"\u25B6\uFE0F"},completed:{label:"Pubblicato",class:"status-completed",icon:"\u2705"},failed:{label:"Fallito",class:"status-failed",icon:"\u274C"}};return a[d]||a.pending},N=d=>{let a=new Date(d),v=new Date().getTime()-a.getTime(),s=Math.floor(v/6e4),e=Math.floor(s/60),i=Math.floor(e/24);if(v<0){let f=Math.abs(s),w=Math.abs(e),C=Math.abs(i);if(f<1)return"Ora";if(f<60)return`Tra ${f} min`;if(w<24)return`Tra ${w} ore`;if(C<7)return`Tra ${C} giorni`}return s<1?"Adesso":s<60?`${s} min fa`:e<24?`${e} ore fa`:i<7?`${i} giorni fa`:a.toLocaleDateString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})};return y?React.createElement("div",{className:"fp-dashboard loading"},React.createElement("div",{className:"loading-spinner"},"Caricamento dashboard...")):React.createElement("div",{className:"fp-dashboard"},React.createElement("div",{className:"dashboard-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F4CA} Dashboard"),n&&React.createElement("p",{className:"client-subtitle"},"Cliente: ",React.createElement("strong",null,n.name))),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"\u270F\uFE0F Nuovo Post"),React.createElement("button",{className:"button",onClick:o},"\u{1F504} Aggiorna"))),React.createElement("div",{className:"stats-grid"},React.createElement("div",{className:"stat-card scheduled"},React.createElement("div",{className:"stat-icon"},"\u23F1\uFE0F"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},u.scheduled),React.createElement("div",{className:"stat-label"},"Schedulati"))),React.createElement("div",{className:"stat-card published"},React.createElement("div",{className:"stat-icon"},"\u2705"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},u.published_month),React.createElement("div",{className:"stat-label"},"Pubblicati (mese)"))),React.createElement("div",{className:"stat-card failed"},React.createElement("div",{className:"stat-icon"},"\u274C"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},u.failed),React.createElement("div",{className:"stat-label"},"Falliti"))),React.createElement("div",{className:"stat-card accounts"},React.createElement("div",{className:"stat-icon"},"\u{1F4F1}"),React.createElement("div",{className:"stat-content"},React.createElement("div",{className:"stat-value"},u.total_accounts),React.createElement("div",{className:"stat-label"},"Account Connessi")))),React.createElement("div",{className:"quick-actions"},React.createElement("h2",null,"\u26A1 Azioni Rapide"),React.createElement("div",{className:"actions-grid"},React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},React.createElement("span",{className:"action-icon"},"\u270F\uFE0F"),React.createElement("span",{className:"action-label"},"Componi Post")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-calendar"},React.createElement("span",{className:"action-icon"},"\u{1F4C5}"),React.createElement("span",{className:"action-label"},"Calendario")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-library"},React.createElement("span",{className:"action-icon"},"\u{1F5BC}\uFE0F"),React.createElement("span",{className:"action-label"},"Libreria Media")),React.createElement("button",{className:"action-card",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-analytics"},React.createElement("span",{className:"action-icon"},"\u{1F4C8}"),React.createElement("span",{className:"action-label"},"Analytics")))),React.createElement("div",{className:"recent-activity"},React.createElement("div",{className:"section-header"},React.createElement("h2",null,"\u{1F552} Attivit\xE0 Recente"),React.createElement("a",{href:"/wp-admin/admin.php?page=fp-publisher-jobs",className:"view-all"},"Vedi tutti \u2192")),p.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessuna attivit\xE0 recente"),React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"Crea il tuo primo post")):React.createElement("div",{className:"activity-list"},p.map(d=>{var c,v,s,e;let a=g(d.status);return React.createElement("div",{key:d.id,className:"activity-item"},React.createElement("div",{className:"activity-icon"},b(d.channel)),React.createElement("div",{className:"activity-content"},React.createElement("div",{className:"activity-title"},((v=(c=d.payload)==null?void 0:c.message)==null?void 0:v.substring(0,60))||"Post senza titolo",((e=(s=d.payload)==null?void 0:s.message)==null?void 0:e.length)>60&&"..."),React.createElement("div",{className:"activity-meta"},React.createElement("span",{className:"channel-name"},d.channel),React.createElement("span",{className:"separator"},"\u2022"),React.createElement("span",{className:"time"},N(d.run_at)))),React.createElement("div",{className:"activity-status"},React.createElement("span",{className:`status-badge ${a.class}`},a.icon," ",a.label)))}))),n&&React.createElement("div",{className:"client-limits"},React.createElement("h2",null,"\u{1F4CA} Limiti Piano"),React.createElement("div",{className:"limits-grid"},React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Canali massimi:"),React.createElement("span",{className:"limit-value"},u.total_accounts," / ",n.limits.max_channels===Number.MAX_SAFE_INTEGER?"\u221E":n.limits.max_channels)),React.createElement("div",{className:"limit-item"},React.createElement("span",{className:"limit-label"},"Post mensili:"),React.createElement("span",{className:"limit-value"},u.published_month," / ",n.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"\u221E":n.limits.max_posts_monthly)))))};var S=A("@wordpress/element");var J=()=>{var $;let{selectedClientId:t,currentClient:n}=z(),[u,r]=(0,S.useState)(""),[p,m]=(0,S.useState)([]),[y,h]=(0,S.useState)([]),[o,b]=(0,S.useState)([]),[g,N]=(0,S.useState)(""),[d,a]=(0,S.useState)(""),[c,v]=(0,S.useState)(!1);(0,S.useEffect)(()=>{t&&s()},[t]),(0,S.useEffect)(()=>()=>{o.forEach(l=>{l.url.startsWith("blob:")&&URL.revokeObjectURL(l.url)})},[o]);let s=async()=>{var l;if(t)try{let x=await fetch(`/wp-json/fp-publisher/v1/clients/${t}/accounts`);if(!x.ok)throw new Error(`HTTP error! status: ${x.status}`);let _=await x.json(),E=[{id:"meta_facebook",name:"Facebook",icon:"\u{1F4D8}",connected:!1},{id:"meta_instagram",name:"Instagram",icon:"\u{1F4F7}",connected:!1},{id:"youtube",name:"YouTube",icon:"\u{1F4F9}",connected:!1},{id:"tiktok",name:"TikTok",icon:"\u{1F3B5}",connected:!1},{id:"google_business",name:"Google Business",icon:"\u{1F5FA}\uFE0F",connected:!1},{id:"wordpress_blog",name:"WordPress",icon:"\u{1F4DD}",connected:!0}],k=new Set(((l=_.accounts)==null?void 0:l.map(M=>M.channel))||[]),H=E.map(M=>{var U;let O=(U=_.accounts)==null?void 0:U.find(ie=>ie.channel===M.id);return O?{...M,connected:!0,accountName:O.account_name}:M});h(H)}catch(x){console.error("Failed to fetch accounts:",x)}},e=l=>{m(x=>x.includes(l)?x.filter(_=>_!==l):[...x,l])},i=l=>{let x=l.target.files;if(!x||x.length===0)return;let _=50*1024*1024,E=[];Array.from(x).forEach(k=>{if(k.size>_){E.push(`${k.name} (${(k.size/1024/1024).toFixed(2)}MB)`);return}if(!k.type.startsWith("image/")&&!k.type.startsWith("video/")){E.push(`${k.name} (tipo non supportato)`);return}let H=URL.createObjectURL(k),M=k.type.startsWith("image/")?"image":"video",O=`${Date.now()}-${Math.random().toString(36).substring(2,11)}`;b(U=>[...U,{id:O,url:H,type:M}])}),E.length>0&&alert(`File non validi:
${E.join(`
`)}

Dimensione massima: 50MB`),l.target.value=""},f=l=>{b(x=>{let _=x.find(E=>E.id===l);return _&&_.url.startsWith("blob:")&&URL.revokeObjectURL(_.url),x.filter(E=>E.id!==l)})},w=async(l=!1)=>{if(!c){if(!t){alert("Seleziona un cliente prima di pubblicare");return}if(p.length===0){alert("Seleziona almeno un canale");return}if(!u.trim()){alert("Inserisci un messaggio");return}v(!0);try{let x=new Date().toISOString();if(g&&d){let k=new Date(`${g}T${d}`);if(isNaN(k.getTime())){alert("\u274C Data o ora non valida"),v(!1);return}if(k<new Date){alert("\u274C La data di pubblicazione deve essere futura"),v(!1);return}x=k.toISOString()}let _=await fetch("/wp-json/fp-publisher/v1/publish/multi-channel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,channels:p,plan:{brand:(n==null?void 0:n.name)||"Brand",channels:p,slots:p.map(k=>({channel:k,scheduled_at:x})),template:{title:u.substring(0,100),content:u},status:l?"draft":"ready"},payload:{message:u,media:o.map(k=>({source:k.url,type:k.type}))},publish_at:x})});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);let E=await _.json();E.success?(alert(`\u2705 ${l?"Bozza salvata":"Pubblicato"} con successo su ${E.published} canali!`),o.forEach(k=>{k.url.startsWith("blob:")&&URL.revokeObjectURL(k.url)}),r(""),m([]),b([]),N(""),a(""),window.location.href="/wp-admin/admin.php?page=fp-publisher"):alert("\u274C Errore durante la pubblicazione")}catch(x){console.error("Publish failed:",x),alert("\u274C Errore durante la pubblicazione")}finally{v(!1)}}},C=u.length,D=2200;return t?React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-header"},React.createElement("h1",null,"\u270F\uFE0F Componi Post"),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button",onClick:()=>w(!0),disabled:c},"\u{1F4BE} Salva Bozza"),React.createElement("button",{className:"button button-primary",onClick:()=>w(!1),disabled:c||p.length===0},c?"\u23F3 Pubblicando...":"\u{1F680} Pubblica"))),React.createElement("div",{className:"composer-layout"},React.createElement("div",{className:"composer-main"},React.createElement("div",{className:"message-editor"},React.createElement("textarea",{value:u,onChange:l=>r(l.target.value),placeholder:"Cosa vuoi condividere?",className:"message-textarea",rows:8,"aria-label":"Messaggio del post",disabled:c,maxLength:D}),React.createElement("div",{className:"editor-footer"},React.createElement("div",{className:"char-counter"},React.createElement("span",{className:C>D?"over-limit":""},C),React.createElement("span",{className:"separator"},"/"),React.createElement("span",null,D)),React.createElement("div",{className:"editor-tools"},React.createElement("button",{className:"tool-button",onClick:()=>{let l=prompt("Inserisci emoji:");l&&r(x=>x+l)},title:"Aggiungi emoji"},"\u{1F600}"),React.createElement("button",{className:"tool-button",onClick:()=>{let l=prompt("Inserisci hashtag (senza #):");l&&r(x=>x+" #"+l)},title:"Aggiungi hashtag"},"#\uFE0F\u20E3")))),React.createElement("div",{className:"media-section"},React.createElement("div",{className:"media-header"},React.createElement("h3",null,"\u{1F5BC}\uFE0F Media"),React.createElement("label",{className:"button button-small"},"\u{1F4E4} Carica Media",React.createElement("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:i,style:{display:"none"}}))),o.length>0&&React.createElement("div",{className:"media-grid"},o.map(l=>React.createElement("div",{key:l.id,className:"media-item"},l.type==="image"?React.createElement("img",{src:l.url,alt:"Preview"}):React.createElement("video",{src:l.url,controls:!0}),React.createElement("button",{className:"remove-media",onClick:()=>f(l.id)},"\u2715"))))),React.createElement("div",{className:"scheduling-section"},React.createElement("h3",null,"\u23F0 Programmazione"),React.createElement("div",{className:"scheduling-inputs"},React.createElement("div",{className:"input-group"},React.createElement("label",{htmlFor:"scheduled-date"},"Data"),React.createElement("input",{id:"scheduled-date",type:"date",value:g,onChange:l=>N(l.target.value),min:new Date().toISOString().split("T")[0],disabled:c})),React.createElement("div",{className:"input-group"},React.createElement("label",{htmlFor:"scheduled-time"},"Ora"),React.createElement("input",{id:"scheduled-time",type:"time",value:d,onChange:l=>a(l.target.value),disabled:c})),g&&d&&React.createElement("button",{type:"button",className:"button button-small",onClick:()=>{N(""),a("")},disabled:c},"\u2715 Rimuovi")),!g&&!d&&React.createElement("p",{className:"scheduling-hint"},"\u{1F4A1} Lascia vuoto per pubblicare immediatamente"))),React.createElement("div",{className:"composer-sidebar"},React.createElement("div",{className:"channels-section"},React.createElement("h3",null,"\u{1F4F1} Canali di Pubblicazione"),React.createElement("p",{className:"channels-hint"},"Seleziona i canali dove pubblicare questo post"),React.createElement("div",{className:"channels-list"},y.map(l=>React.createElement("div",{key:l.id,className:`channel-item ${l.connected?"":"disabled"} ${p.includes(l.id)?"selected":""}`,onClick:()=>l.connected&&e(l.id)},React.createElement("div",{className:"channel-info"},React.createElement("span",{className:"channel-icon"},l.icon),React.createElement("div",{className:"channel-details"},React.createElement("div",{className:"channel-name"},l.name),l.accountName&&React.createElement("div",{className:"channel-account"},l.accountName),!l.connected&&React.createElement("div",{className:"channel-status"},"Non connesso"))),l.connected&&React.createElement("div",{className:"channel-checkbox"},React.createElement("input",{type:"checkbox",checked:p.includes(l.id),onChange:x=>x.stopPropagation(),readOnly:!0}))))),p.length>0&&React.createElement("div",{className:"selected-count"},"\u2705 ",p.length," canale",p.length>1?"i":""," selezionat",p.length>1?"i":"o"),React.createElement("button",{className:"button button-full",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${t}`},"\u2699\uFE0F Gestisci Account")),u&&React.createElement("div",{className:"preview-section"},React.createElement("h3",null,"\u{1F441}\uFE0F Anteprima"),React.createElement("div",{className:"preview-card"},React.createElement("div",{className:"preview-header"},React.createElement("span",{className:"preview-avatar"},n!=null&&n.logo_url?React.createElement("img",{src:n.logo_url,alt:n.name}):React.createElement("span",{style:{backgroundColor:(n==null?void 0:n.color)||"#666"}},($=n==null?void 0:n.name)==null?void 0:$.substring(0,2).toUpperCase())),React.createElement("div",{className:"preview-author"},React.createElement("div",{className:"preview-name"},n==null?void 0:n.name),React.createElement("div",{className:"preview-time"},"Adesso"))),React.createElement("div",{className:"preview-content"},u),o.length>0&&o[0]&&React.createElement("div",{className:"preview-media"},o[0].type==="image"?React.createElement("img",{src:o[0].url,alt:"Preview"}):React.createElement("video",{src:o[0].url}))))))):React.createElement("div",{className:"fp-composer"},React.createElement("div",{className:"composer-empty"},React.createElement("h2",null,"\u26A0\uFE0F Nessun Cliente Selezionato"),React.createElement("p",null,"Seleziona un cliente dal menu in alto per iniziare a comporre")))};var I=A("@wordpress/element");var G=()=>{let{selectedClientId:t}=z(),[n,u]=(0,I.useState)(new Date),[r,p]=(0,I.useState)([]),[m,y]=(0,I.useState)("month"),h=(0,I.useCallback)(async()=>{if(t)try{let v=new URLSearchParams({client_id:t.toString()}),s=await fetch(`/wp-json/fp-publisher/v1/jobs?${v}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let i=((await s.json()).jobs||[]).filter(f=>f.run_at).map(f=>{var C,D,$;let w=f.run_at.split("T");return{id:f.id,title:((D=(C=f.payload)==null?void 0:C.message)==null?void 0:D.substring(0,50))||"Post",channel:f.channel,date:w[0]||"",time:(($=w[1])==null?void 0:$.substring(0,5))||"00:00",status:f.status}});p(i)}catch(v){console.error("Failed to fetch events:",v)}},[t]);(0,I.useEffect)(()=>{t&&h()},[t,n,h]);let o=()=>{let v=n.getFullYear(),s=n.getMonth();return new Date(v,s+1,0).getDate()},b=()=>{let v=n.getFullYear(),s=n.getMonth();return new Date(v,s,1).getDay()},g=v=>{let s=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(v).padStart(2,"0")}`;return r.filter(e=>e.date===s)},N=()=>{u(new Date(n.getFullYear(),n.getMonth()-1))},d=()=>{u(new Date(n.getFullYear(),n.getMonth()+1))},a=()=>{u(new Date)},c=()=>{let v=o(),s=b(),e=[];for(let w=0;w<s;w++)e.push(React.createElement("div",{key:`empty-${w}`,className:"calendar-day empty"}));let f=new Date().toDateString();for(let w=1;w<=v;w++){let C=g(w),D=new Date(n.getFullYear(),n.getMonth(),w),$=f===D.toDateString();e.push(React.createElement("div",{key:w,className:`calendar-day ${$?"today":""}`},React.createElement("div",{className:"day-number"},w),React.createElement("div",{className:"day-events"},C.slice(0,3).map(l=>React.createElement("div",{key:l.id,className:`event event-${l.status}`},React.createElement("span",{className:"event-time"},l.time),React.createElement("span",{className:"event-title"},l.title))),C.length>3&&React.createElement("div",{className:"event-more"},"+",C.length-3," altri"))))}return e};return React.createElement("div",{className:"fp-calendar"},React.createElement("div",{className:"calendar-header"},React.createElement("h1",null,"\u{1F4C5} Calendario Pubblicazioni"),React.createElement("div",{className:"calendar-controls"},React.createElement("button",{className:"button",onClick:N},"\u2190 Precedente"),React.createElement("button",{className:"button",onClick:a},"Oggi"),React.createElement("button",{className:"button",onClick:d},"Successivo \u2192"))),React.createElement("div",{className:"calendar-month-title"},n.toLocaleDateString("it-IT",{month:"long",year:"numeric"})),React.createElement("div",{className:"calendar-grid"},React.createElement("div",{className:"calendar-weekdays"},["Dom","Lun","Mar","Mer","Gio","Ven","Sab"].map(v=>React.createElement("div",{key:v,className:"weekday"},v))),React.createElement("div",{className:"calendar-days"},c())),React.createElement("div",{className:"calendar-legend"},React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot pending"}),React.createElement("span",null,"Schedulato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot completed"}),React.createElement("span",null,"Pubblicato")),React.createElement("div",{className:"legend-item"},React.createElement("span",{className:"legend-dot failed"}),React.createElement("span",null,"Fallito"))))};var Y=()=>{let{currentClient:t}=z();return React.createElement("div",{className:"fp-analytics"},React.createElement("h1",null,"\u{1F4C8} Analytics"),React.createElement("div",{className:"analytics-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4CA}"),React.createElement("h2",null,"Analytics in arrivo!"),React.createElement("p",null,"Questa sezione mostrer\xE0 statistiche dettagliate per"," ",t?t.name:"i tuoi clienti",":"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4CA} Performance post per canale"),React.createElement("li",null,"\u{1F4C8} Crescita follower nel tempo"),React.createElement("li",null,"\u{1F4AC} Engagement rate"),React.createElement("li",null,"\u{1F3AF} Migliori orari di pubblicazione"),React.createElement("li",null,"\u{1F4F1} Confronto canali"),React.createElement("li",null,"\u{1F4C5} Report mensili")),React.createElement("button",{className:"button button-primary"},"\u{1F680} Richiedi Demo Analytics")))};var V=()=>React.createElement("div",{className:"fp-media-library"},React.createElement("h1",null,"\u{1F5BC}\uFE0F Libreria Media"),React.createElement("div",{className:"library-placeholder"},React.createElement("div",{className:"placeholder-icon"},"\u{1F4C1}"),React.createElement("h2",null,"Libreria Media in arrivo!"),React.createElement("p",null,"Qui potrai gestire tutti i tuoi asset multimediali:"),React.createElement("ul",null,React.createElement("li",null,"\u{1F4F7} Immagini"),React.createElement("li",null,"\u{1F3AC} Video"),React.createElement("li",null,"\u{1F3B5} Audio"),React.createElement("li",null,"\u{1F4C4} Documenti"),React.createElement("li",null,"\u{1F3F7}\uFE0F Tag e organizzazione"),React.createElement("li",null,"\u{1F50D} Ricerca avanzata")),React.createElement("button",{className:"button button-primary"},"\u{1F4E4} Carica i tuoi primi media")));var F=A("@wordpress/element"),q=()=>{let[t,n]=(0,F.useState)([]),[u,r]=(0,F.useState)(!0),[p,m]=(0,F.useState)(!1),[y,h]=(0,F.useState)(null),[o,b]=(0,F.useState)(""),g=(0,F.useCallback)(async()=>{r(!0);try{let e=await fetch("/wp-json/fp-publisher/v1/clients");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let i=await e.json();n(i.clients||[])}catch(e){console.error("Failed to fetch clients:",e)}finally{r(!1)}},[]);(0,F.useEffect)(()=>{g()},[g]);let N=()=>{h(null),m(!0)},d=e=>{h(e),m(!0)},a=async e=>{if(confirm(`Sei sicuro di voler eliminare il cliente "${e.name}"? Questa azione non pu\xF2 essere annullata.`))try{let i=await fetch(`/wp-json/fp-publisher/v1/clients/${e.id}`,{method:"DELETE"});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);g()}catch(i){console.error("Failed to delete client:",i),alert("Errore durante l'eliminazione del cliente")}},c=t.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.slug.toLowerCase().includes(o.toLowerCase())),v=e=>{let i={active:{label:"Attivo",class:"status-active",icon:"\u2705"},paused:{label:"Pausato",class:"status-paused",icon:"\u23F8\uFE0F"},archived:{label:"Archiviato",class:"status-archived",icon:"\u{1F4E6}"}};return i[e]||i.active},s=e=>{let i={free:{label:"Free",class:"plan-free"},basic:{label:"Basic",class:"plan-basic"},pro:{label:"Pro",class:"plan-pro"},agency:{label:"Agency",class:"plan-agency"},enterprise:{label:"Enterprise",class:"plan-enterprise"}};return i[e]||i.free};return React.createElement("div",{className:"fp-clients-management"},React.createElement("div",{className:"page-header"},React.createElement("h1",null,"\u{1F465} Gestione Clienti"),React.createElement("button",{className:"button button-primary",onClick:N},"+ Nuovo Cliente")),React.createElement("div",{className:"clients-toolbar"},React.createElement("div",{className:"search-box"},React.createElement("input",{type:"search",placeholder:"\u{1F50D} Cerca clienti...",value:o,onChange:e=>b(e.target.value)})),React.createElement("div",{className:"filters"})),u?React.createElement("div",{className:"loading-state"},"Caricamento clienti..."):c.length===0?React.createElement("div",{className:"empty-state"},React.createElement("p",null,"Nessun cliente trovato."),React.createElement("button",{className:"button button-primary",onClick:N},"Crea il tuo primo cliente")):React.createElement("div",{className:"clients-grid"},c.map(e=>{let i=v(e.status),f=s(e.billing_plan);return React.createElement("div",{key:e.id,className:"client-card"},React.createElement("div",{className:"client-card-header"},React.createElement("div",{className:"client-info"},e.logo_url?React.createElement("img",{src:e.logo_url,alt:e.name,className:"client-card-logo"}):React.createElement("span",{className:"client-card-badge",style:{backgroundColor:e.color}},e.name.substring(0,2).toUpperCase()),React.createElement("div",null,React.createElement("h3",null,e.name),React.createElement("span",{className:`status-badge ${i.class}`},i.icon," ",i.label)))),React.createElement("div",{className:"client-card-body"},React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4F1} Canali:"),React.createElement("span",{className:"stat-value"},e.limits.max_channels===Number.MAX_SAFE_INTEGER?"Illimitati":e.limits.max_channels)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4CA} Post/mese:"),React.createElement("span",{className:"stat-value"},e.limits.max_posts_monthly===Number.MAX_SAFE_INTEGER?"Illimitati":e.limits.max_posts_monthly)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F465} Team:"),React.createElement("span",{className:"stat-value"},"Max ",e.limits.max_team_members===Number.MAX_SAFE_INTEGER?"Illimitati":e.limits.max_team_members)),React.createElement("div",{className:"client-stat"},React.createElement("span",{className:"stat-label"},"\u{1F4B0} Piano:"),React.createElement("span",{className:`plan-badge ${f.class}`},f.label))),React.createElement("div",{className:"client-card-footer"},React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher&client_id=${e.id}`},"Dashboard"),React.createElement("button",{className:"button button-small",onClick:()=>d(e)},"Modifica"),React.createElement("button",{className:"button button-small",onClick:()=>window.location.href=`/wp-admin/admin.php?page=fp-publisher-accounts&client_id=${e.id}`},"Account Social"),React.createElement("button",{className:"button button-small button-link-delete",onClick:()=>a(e)},"Elimina")))})),p&&React.createElement(ne,{client:y,onClose:()=>{m(!1),h(null)},onSave:()=>{m(!1),h(null),g()}}))},ne=({client:t,onClose:n,onSave:u})=>{let[r,p]=(0,F.useState)({name:(t==null?void 0:t.name)||"",slug:(t==null?void 0:t.slug)||"",logo_url:(t==null?void 0:t.logo_url)||"",website:(t==null?void 0:t.website)||"",industry:(t==null?void 0:t.industry)||"",timezone:(t==null?void 0:t.timezone)||"Europe/Rome",color:(t==null?void 0:t.color)||"#666666",status:(t==null?void 0:t.status)||"active"}),[m,y]=(0,F.useState)(!1);return(0,F.useEffect)(()=>{t&&p({name:t.name||"",slug:t.slug||"",logo_url:t.logo_url||"",website:t.website||"",industry:t.industry||"",timezone:t.timezone||"Europe/Rome",color:t.color||"#666666",status:t.status||"active"})},[t]),React.createElement("div",{className:"fp-modal-overlay",onClick:n},React.createElement("div",{className:"fp-modal",onClick:o=>o.stopPropagation()},React.createElement("div",{className:"modal-header"},React.createElement("h2",null,t?"\u270F\uFE0F Modifica Cliente":"\u2795 Nuovo Cliente"),React.createElement("button",{className:"close-button",onClick:n},"\u2715")),React.createElement("form",{onSubmit:async o=>{o.preventDefault(),y(!0);try{let b=t?`/wp-json/fp-publisher/v1/clients/${t.id}`:"/wp-json/fp-publisher/v1/clients",N=await fetch(b,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!N.ok)throw new Error(`HTTP error! status: ${N.status}`);u(),n()}catch(b){console.error("Failed to save client:",b),alert("Errore durante il salvataggio del cliente")}finally{y(!1)}}},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"name"},"Nome Cliente *"),React.createElement("input",{type:"text",id:"name",value:r.name,onChange:o=>p({...r,name:o.target.value}),required:!0})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"slug"},"Slug (URL-friendly)"),React.createElement("input",{type:"text",id:"slug",value:r.slug,onChange:o=>p({...r,slug:o.target.value}),placeholder:"Auto-generato dal nome"}),React.createElement("small",null,"Lascia vuoto per generazione automatica")),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"logo_url"},"URL Logo"),React.createElement("input",{type:"url",id:"logo_url",value:r.logo_url,onChange:o=>p({...r,logo_url:o.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"website"},"Sito Web"),React.createElement("input",{type:"url",id:"website",value:r.website,onChange:o=>p({...r,website:o.target.value}),placeholder:"https://..."})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"industry"},"Settore"),React.createElement("select",{id:"industry",value:r.industry,onChange:o=>p({...r,industry:o.target.value})},React.createElement("option",{value:""},"Seleziona settore"),React.createElement("option",{value:"technology"},"Technology"),React.createElement("option",{value:"food"},"Food & Beverage"),React.createElement("option",{value:"retail"},"Retail"),React.createElement("option",{value:"healthcare"},"Healthcare"),React.createElement("option",{value:"education"},"Education"),React.createElement("option",{value:"entertainment"},"Entertainment"),React.createElement("option",{value:"other"},"Altro"))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"timezone"},"Timezone"),React.createElement("select",{id:"timezone",value:r.timezone,onChange:o=>p({...r,timezone:o.target.value})},React.createElement("option",{value:"UTC"},"UTC"),React.createElement("option",{value:"Europe/Rome"},"Europe/Rome"),React.createElement("option",{value:"Europe/London"},"Europe/London"),React.createElement("option",{value:"America/New_York"},"America/New_York"),React.createElement("option",{value:"America/Los_Angeles"},"America/Los_Angeles")))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"color"},"Colore Brand"),React.createElement("div",{className:"color-picker"},React.createElement("input",{type:"color",id:"color",value:r.color,onChange:o=>p({...r,color:o.target.value})}),React.createElement("input",{type:"text",value:r.color,onChange:o=>p({...r,color:o.target.value}),placeholder:"#666666",pattern:"^#[0-9A-Fa-f]{6}$"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"billing_plan"},"Piano di Fatturazione"),React.createElement("select",{id:"billing_plan",value:r.billing_plan,onChange:o=>p({...r,billing_plan:o.target.value})},React.createElement("option",{value:"free"},"Free"),React.createElement("option",{value:"basic"},"Basic (\u20AC15/mese)"),React.createElement("option",{value:"pro"},"Pro (\u20AC29/mese)"),React.createElement("option",{value:"agency"},"Agency (\u20AC99/mese)"),React.createElement("option",{value:"enterprise"},"Enterprise (Custom)")))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Status"),React.createElement("div",{className:"radio-group"},React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"active",checked:r.status==="active",onChange:o=>p({...r,status:o.target.value})}),"Attivo"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"paused",checked:r.status==="paused",onChange:o=>p({...r,status:o.target.value})}),"Pausato"),React.createElement("label",null,React.createElement("input",{type:"radio",name:"status",value:"archived",checked:r.status==="archived",onChange:o=>p({...r,status:o.target.value})}),"Archiviato")))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"button",onClick:n,disabled:m},"Annulla"),t&&React.createElement("button",{type:"button",className:"button button-link-delete",onClick:()=>{handleDeleteClient(t),n()},disabled:m},"Elimina Cliente"),React.createElement("button",{type:"submit",className:"button button-primary",disabled:m},m?"Salvataggio...":"\u{1F4BE} Salva Modifiche")))))};var R=A("@wordpress/element");var Q=()=>{let{selectedClientId:t,currentClient:n}=z(),[u,r]=(0,R.useState)([]),[p,m]=(0,R.useState)(!0),y=(0,R.useCallback)(async()=>{if(t){m(!0);try{let a=await fetch(`/wp-json/fp-publisher/v1/clients/${t}/accounts`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let c=await a.json();r(c.accounts||[])}catch(a){console.error("Failed to fetch accounts:",a)}finally{m(!1)}}},[t]);(0,R.useEffect)(()=>{t&&y()},[t,y]);let h=a=>{alert(`Connessione OAuth per ${a} - Implementare flow OAuth 2.0`)},o=async a=>{if(t&&confirm("Vuoi davvero disconnettere questo account?"))try{let c=await fetch(`/wp-json/fp-publisher/v1/clients/${t}/accounts/${a}`,{method:"DELETE"});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);y()}catch(c){console.error("Failed to disconnect account:",c),alert("Errore durante la disconnessione")}},b=a=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[a]||"\u{1F4F1}",g=a=>({meta_facebook:"Facebook",meta_instagram:"Instagram",youtube:"YouTube",tiktok:"TikTok",google_business:"Google Business",wordpress_blog:"WordPress Blog"})[a]||a,N=[{id:"meta_facebook",name:"Facebook",icon:"\u{1F4D8}",oauth:!0},{id:"meta_instagram",name:"Instagram",icon:"\u{1F4F7}",oauth:!0},{id:"youtube",name:"YouTube",icon:"\u{1F4F9}",oauth:!0},{id:"tiktok",name:"TikTok",icon:"\u{1F3B5}",oauth:!0},{id:"google_business",name:"Google Business",icon:"\u{1F5FA}\uFE0F",oauth:!0},{id:"wordpress_blog",name:"WordPress Blog",icon:"\u{1F4DD}",oauth:!1}],d=a=>u.some(c=>c.channel===a&&c.status==="active");return t?React.createElement("div",{className:"fp-social-accounts"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F50C} Account Social"),n&&React.createElement("p",{className:"subtitle"},"Cliente: ",React.createElement("strong",null,n.name))),React.createElement("button",{className:"button",onClick:y},"\u{1F504} Aggiorna")),p?React.createElement("div",{className:"loading-spinner"},"Caricamento account..."):React.createElement(React.Fragment,null,u.length>0&&React.createElement("div",{className:"section"},React.createElement("h2",null,"\u2705 Account Connessi (",u.length,")"),React.createElement("div",{className:"accounts-grid"},u.map(a=>React.createElement("div",{key:a.id,className:"account-card connected"},React.createElement("div",{className:"account-icon"},b(a.channel)),React.createElement("div",{className:"account-info"},React.createElement("h3",null,g(a.channel)),React.createElement("p",{className:"account-name"},a.account_name),React.createElement("p",{className:"account-meta"},"Connesso il ",new Date(a.connected_at).toLocaleDateString("it-IT"))),React.createElement("div",{className:"account-actions"},React.createElement("span",{className:"status-badge active"},"\u2713 Attivo"),React.createElement("button",{className:"button button-link-delete",onClick:()=>o(a.id)},"Disconnetti")))))),React.createElement("div",{className:"section"},React.createElement("h2",null,"\u2795 Connetti Nuovo Account"),React.createElement("div",{className:"channels-grid"},N.map(a=>{let c=d(a.id);return React.createElement("div",{key:a.id,className:`channel-card ${c?"disabled":""}`},React.createElement("div",{className:"channel-icon"},a.icon),React.createElement("h3",null,a.name),a.oauth&&React.createElement("p",{className:"channel-meta"},"OAuth 2.0"),c?React.createElement("button",{className:"button",disabled:!0},"\u2713 Connesso"):React.createElement("button",{className:"button button-primary",onClick:()=>h(a.id)},"+ Connetti"))}))),React.createElement("div",{className:"section help-section"},React.createElement("h3",null,"\u2139\uFE0F Come Connettere Account"),React.createElement("ol",null,React.createElement("li",null,'Click su "',React.createElement("strong",null,"+ Connetti"),'" per il canale desiderato'),React.createElement("li",null,"Segui il flusso OAuth 2.0 (login + autorizzazione)"),React.createElement("li",null,`Una volta connesso, l'account apparir\xE0 in "Account Connessi"`),React.createElement("li",null,"Potrai usarlo nel Composer per pubblicare contenuti")),React.createElement("div",{className:"info-box"},React.createElement("strong",null,"\u{1F4A1} Nota:")," WordPress Blog non richiede OAuth perch\xE9 pubblichi direttamente sul tuo sito WordPress locale.")))):React.createElement("div",{className:"fp-social-accounts"},React.createElement("div",{className:"empty-state"},React.createElement("h2",null,"\u{1F50C} Account Social"),React.createElement("p",null,"Seleziona un cliente dal dropdown in alto per gestire gli account social.")))};var P=A("@wordpress/element");var X=()=>{let{selectedClientId:t}=z(),[n,u]=(0,P.useState)([]),[r,p]=(0,P.useState)(!0),[m,y]=(0,P.useState)("all"),[h,o]=(0,P.useState)(1),[b,g]=(0,P.useState)(0),N=20,d=(0,P.useCallback)(async()=>{p(!0);try{let e=new URLSearchParams;t&&e.set("client_id",t.toString()),m!=="all"&&e.set("status",m),e.set("limit",N.toString()),e.set("offset",((h-1)*N).toString());let i=await fetch(`/wp-json/fp-publisher/v1/jobs?${e}`);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);let f=await i.json();u(f.jobs||[]),g(f.total||0)}catch(e){console.error("Failed to fetch jobs:",e)}finally{p(!1)}},[t,m,h,N]);(0,P.useEffect)(()=>{d()},[d]);let a=e=>({meta_facebook:"\u{1F4D8}",meta_instagram:"\u{1F4F7}",youtube:"\u{1F4F9}",tiktok:"\u{1F3B5}",google_business:"\u{1F5FA}\uFE0F",wordpress_blog:"\u{1F4DD}"})[e]||"\u{1F4F1}",c=e=>{let i={pending:{label:"In attesa",class:"status-pending",icon:"\u23F1\uFE0F"},running:{label:"In esecuzione",class:"status-running",icon:"\u25B6\uFE0F"},completed:{label:"Completato",class:"status-completed",icon:"\u2705"},failed:{label:"Fallito",class:"status-failed",icon:"\u274C"}};return i[e]||i.pending},v=e=>new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}),s=N>0?Math.ceil(b/N):1;return React.createElement("div",{className:"fp-jobs"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u{1F4CB} Cronologia Job"),React.createElement("p",{className:"subtitle"},"Visualizza lo stato di tutti i job di pubblicazione")),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"button",onClick:d},"\u{1F504} Aggiorna"))),React.createElement("div",{className:"filters"},React.createElement("div",{className:"filter-group"},React.createElement("label",null,"Filtra per stato:"),React.createElement("select",{value:m,onChange:e=>{y(e.target.value),o(1)}},React.createElement("option",{value:"all"},"Tutti"),React.createElement("option",{value:"pending"},"In attesa"),React.createElement("option",{value:"running"},"In esecuzione"),React.createElement("option",{value:"completed"},"Completati"),React.createElement("option",{value:"failed"},"Falliti"))),React.createElement("div",{className:"stats-inline"},React.createElement("span",null,"Totale job: ",React.createElement("strong",null,b)),s>1&&React.createElement("span",null,"Pagina ",React.createElement("strong",null,h)," di ",React.createElement("strong",null,s)))),r?React.createElement("div",{className:"loading-spinner"},"Caricamento job..."):n.length===0?React.createElement("div",{className:"empty-state"},React.createElement("h2",null,"\u{1F4ED} Nessun Job Trovato"),React.createElement("p",null,"Non ci sono job ",m!=="all"?`con stato "${m}"`:"in questo momento","."),React.createElement("button",{className:"button button-primary",onClick:()=>window.location.href="/wp-admin/admin.php?page=fp-publisher-composer"},"\u270F\uFE0F Crea Nuovo Post")):React.createElement(React.Fragment,null,React.createElement("div",{className:"jobs-table"},React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"ID"),React.createElement("th",null,"Canale"),React.createElement("th",null,"Messaggio"),React.createElement("th",null,"Stato"),React.createElement("th",null,"Programmato per"),React.createElement("th",null,"Tentativi"),React.createElement("th",null,"Azioni"))),React.createElement("tbody",null,n.map(e=>{var f,w,C;let i=c(e.status);return React.createElement("tr",{key:e.id},React.createElement("td",null,"#",e.id),React.createElement("td",null,React.createElement("span",{className:"channel-badge"},a(e.channel)," ",e.channel)),React.createElement("td",{className:"message-cell"},((w=(f=e.payload)==null?void 0:f.message)==null?void 0:w.substring(0,50))||"N/A",((C=e.payload)==null?void 0:C.message)&&e.payload.message.length>50&&"..."),React.createElement("td",null,React.createElement("span",{className:`status-badge ${i.class}`},i.icon," ",i.label)),React.createElement("td",null,v(e.run_at)),React.createElement("td",null,React.createElement("span",{className:e.attempts>1?"text-warning":""},e.attempts)),React.createElement("td",null,React.createElement("button",{className:"button button-small",onClick:()=>alert(`Job #${e.id}

Dettagli:
${JSON.stringify(e,null,2)}`)},"\u{1F441}\uFE0F Dettagli")))})))),s>1&&React.createElement("div",{className:"pagination"},React.createElement("button",{className:"button",disabled:h===1,onClick:()=>o(h-1)},"\u2190 Precedente"),React.createElement("span",{className:"page-info"},"Pagina ",h," di ",s),React.createElement("button",{className:"button",disabled:h===s,onClick:()=>o(h+1)},"Successiva \u2192")),React.createElement("div",{className:"legend"},React.createElement("h3",null,"Legenda Stati"),React.createElement("ul",null,React.createElement("li",null,React.createElement("span",{className:"status-badge status-pending"},"\u23F1\uFE0F In attesa")," - Job programmato, in attesa di esecuzione"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-running"},"\u25B6\uFE0F In esecuzione")," - Worker sta processando il job"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-completed"},"\u2705 Completato")," - Pubblicato con successo"),React.createElement("li",null,React.createElement("span",{className:"status-badge status-failed"},"\u274C Fallito")," - Errore durante la pubblicazione")))))};var T=A("@wordpress/element"),K=()=>{var c,v;let[t,n]=(0,T.useState)({worker_enabled:!0,worker_interval:60,max_retries:3,retry_backoff:300,circuit_breaker_enabled:!0,circuit_breaker_threshold:5,metrics_enabled:!0}),[u,r]=(0,T.useState)([{service:"meta_facebook",label:"Facebook",icon:"\u{1F4D8}",token:"",description:"Token di accesso per Facebook Graph API"},{service:"meta_instagram",label:"Instagram",icon:"\u{1F4F7}",token:"",description:"Token di accesso per Instagram Business API"},{service:"youtube",label:"YouTube",icon:"\u{1F4F9}",token:"",description:"API Key per YouTube Data API v3"},{service:"tiktok",label:"TikTok",icon:"\u{1F3B5}",token:"",description:"Access Token per TikTok Business API"},{service:"google_business",label:"Google Business",icon:"\u{1F5FA}\uFE0F",token:"",description:"API Key per Google Business Profile API"}]),[p,m]=(0,T.useState)(!1),[y,h]=(0,T.useState)(!1),[o,b]=(0,T.useState)(!0),g=(0,T.useRef)(null);(0,T.useEffect)(()=>{(async()=>{var e;try{let i=await fetch("/wp-json/fp-publisher/v1/settings",{headers:{"X-WP-Nonce":((e=window.fpPublisher)==null?void 0:e.nonce)||""}});if(i.ok){let f=await i.json();f.options&&f.options.tokens&&r(w=>w.map(C=>({...C,token:f.options.tokens[C.service]||""})))}}catch(i){console.error("Failed to load tokens:",i)}finally{b(!1)}})()},[]),(0,T.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]);let N=(s,e)=>{r(i=>i.map(f=>f.service===s?{...f,token:e}:f))},d=async()=>{var s;m(!0),h(!1),g.current&&(clearTimeout(g.current),g.current=null);try{let e={};u.forEach(i=>{i.token.trim()!==""&&(e[i.service]=i.token.trim())});for(let[i,f]of Object.entries(e))if(!(await fetch("/wp-json/fp-publisher/v1/settings",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((s=window.fpPublisher)==null?void 0:s.nonce)||""},body:JSON.stringify({key:`tokens.${i}`,value:f})})).ok)throw new Error(`Failed to save token for ${i}`);h(!0),g.current=window.setTimeout(()=>{h(!1),g.current=null},3e3),setTimeout(()=>{window.location.reload()},1500)}catch(e){console.error("Failed to save tokens:",e),alert("Errore durante il salvataggio dei token")}finally{m(!1)}},a=async()=>{m(!0),h(!1),g.current&&(clearTimeout(g.current),g.current=null);try{await new Promise(s=>setTimeout(s,1e3)),h(!0),g.current=window.setTimeout(()=>{h(!1),g.current=null},3e3)}catch(s){console.error("Failed to save settings:",s),alert("Errore durante il salvataggio delle impostazioni")}finally{m(!1)}};return React.createElement("div",{className:"fp-settings"},React.createElement("div",{className:"page-header"},React.createElement("div",null,React.createElement("h1",null,"\u2699\uFE0F Impostazioni"),React.createElement("p",{className:"subtitle"},"Configura il comportamento del plugin"))),React.createElement("div",{className:"settings-container"},React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F511} Token di Integrazione"),React.createElement("p",{className:"section-description"},"Configura i token di accesso per i vari canali social. Almeno un token \xE8 richiesto per utilizzare il plugin."),o?React.createElement("p",null,"Caricamento token..."):React.createElement(React.Fragment,null,u.map(s=>React.createElement("div",{key:s.service,className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,s.icon," ",s.label)),React.createElement("input",{type:"password",value:s.token,onChange:e=>N(s.service,e.target.value),placeholder:"Inserisci token di accesso...",className:"regular-text"}),React.createElement("p",{className:"setting-description"},s.description))),React.createElement("div",{className:"settings-actions"},React.createElement("button",{className:"button button-primary button-large",onClick:d,disabled:p},p?"\u{1F4BE} Salvataggio...":"\u{1F4BE} Salva Token"),y&&React.createElement("span",{className:"save-notice"},"\u2705 Token salvati con successo!")),React.createElement("div",{className:"info-box",style:{marginTop:"20px"}},React.createElement("strong",null,"\u{1F4A1} Nota:")," I token vengono crittografati automaticamente nel database. Puoi configurare token solo per i canali che intendi utilizzare."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F504} Worker Queue"),React.createElement("p",{className:"section-description"},"Il worker processa i job di pubblicazione in background usando WP-Cron."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:t.worker_enabled,onChange:s=>n({...t,worker_enabled:s.target.checked})}),React.createElement("strong",null,"Abilita Worker")),React.createElement("p",{className:"setting-description"},"Se disabilitato, i job non verranno processati automaticamente.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Intervallo Worker (secondi)")),React.createElement("input",{type:"number",min:"30",max:"600",value:t.worker_interval,onChange:s=>{let e=parseInt(s.target.value,10);isNaN(e)||n({...t,worker_interval:e})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Ogni quanti secondi il worker controlla nuovi job da processare (min: 30, max: 600)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F501} Retry Logic"),React.createElement("p",{className:"section-description"},"Configura come gestire i job falliti."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Tentativi Massimi")),React.createElement("input",{type:"number",min:"1",max:"10",value:t.max_retries,onChange:s=>{let e=parseInt(s.target.value,10);isNaN(e)||n({...t,max_retries:e})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Quante volte riprovare un job fallito prima di spostarlo nel Dead Letter Queue.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Backoff Esponenziale (secondi)")),React.createElement("input",{type:"number",min:"60",max:"3600",value:t.retry_backoff,onChange:s=>{let e=parseInt(s.target.value,10);isNaN(e)||n({...t,retry_backoff:e})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Tempo base tra un tentativo e l'altro. Viene moltiplicato esponenzialmente (60 \u2192 120 \u2192 240)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F6E1}\uFE0F Circuit Breaker"),React.createElement("p",{className:"section-description"},"Protegge da cascading failures quando un'API \xE8 down."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:t.circuit_breaker_enabled,onChange:s=>n({...t,circuit_breaker_enabled:s.target.checked})}),React.createElement("strong",null,"Abilita Circuit Breaker")),React.createElement("p",{className:"setting-description"},"Se un canale fallisce ripetutamente, viene temporaneamente disabilitato.")),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("strong",null,"Soglia Fallimenti")),React.createElement("input",{type:"number",min:"3",max:"20",value:t.circuit_breaker_threshold,onChange:s=>{let e=parseInt(s.target.value,10);isNaN(e)||n({...t,circuit_breaker_threshold:e})},className:"small-input"}),React.createElement("p",{className:"setting-description"},"Dopo quanti fallimenti consecutivi aprire il circuit breaker."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u{1F4CA} Monitoring & Metrics"),React.createElement("p",{className:"section-description"},"Raccogli metriche per monitorare le performance del sistema."),React.createElement("div",{className:"setting-item"},React.createElement("label",{className:"setting-label"},React.createElement("input",{type:"checkbox",checked:t.metrics_enabled,onChange:s=>n({...t,metrics_enabled:s.target.checked})}),React.createElement("strong",null,"Abilita Metriche")),React.createElement("p",{className:"setting-description"},"Traccia job processati, errori, tempi di esecuzione (formato Prometheus-ready)."))),React.createElement("div",{className:"settings-section"},React.createElement("h2",null,"\u2139\uFE0F Informazioni Sistema"),React.createElement("div",{className:"info-grid"},React.createElement("div",{className:"info-item"},React.createElement("strong",null,"PHP Version:"),React.createElement("span",null,((c=window.fpPublisher)==null?void 0:c.phpVersion)||"N/A")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"WordPress Version:"),React.createElement("span",null,((v=window.fpPublisher)==null?void 0:v.wpVersion)||"N/A")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"Plugin Version:"),React.createElement("span",null,"0.2.0")),React.createElement("div",{className:"info-item"},React.createElement("strong",null,"WP-Cron Status:"),React.createElement("span",{className:"status-badge status-completed"},"\u2713 Attivo")))),React.createElement("div",{className:"settings-actions"},React.createElement("button",{className:"button button-primary button-large",onClick:a,disabled:p},p?"\u{1F4BE} Salvataggio...":"\u{1F4BE} Salva Impostazioni"),y&&React.createElement("span",{className:"save-notice"},"\u2705 Impostazioni salvate con successo!")),React.createElement("div",{className:"settings-help"},React.createElement("h3",null,"\u{1F4A1} Suggerimenti"),React.createElement("ul",null,React.createElement("li",null,React.createElement("strong",null,"Worker Interval:")," Un valore basso (30s) significa pubblicazione pi\xF9 rapida ma pi\xF9 carico server."),React.createElement("li",null,React.createElement("strong",null,"Max Retries:")," Aumenta se hai API instabili, diminuisci per fallire velocemente."),React.createElement("li",null,React.createElement("strong",null,"Circuit Breaker:")," Utile in produzione per evitare sprechi quando un'API \xE8 completamente down."),React.createElement("li",null,React.createElement("strong",null,"Metrics:")," Consigliato per production, aiuta a debuggare problemi.")))))};var B=A("@wordpress/element"),Z=({onClientChange:t})=>{let[n,u]=(0,B.useState)([]),[r,p]=(0,B.useState)(()=>{let a=localStorage.getItem("fp_selected_client");if(a){let c=parseInt(a,10);return isNaN(c)?null:c}return null}),[m,y]=(0,B.useState)(!1),[h,o]=(0,B.useState)(!0),b=(0,B.useRef)(null);(0,B.useEffect)(()=>{g()},[]),(0,B.useEffect)(()=>{let a=c=>{b.current&&!b.current.contains(c.target)&&y(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let g=async()=>{try{let a=await fetch("/wp-json/fp-publisher/v1/clients");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let c=await a.json();u(c.clients||[])}catch(a){console.error("Failed to fetch clients:",a)}finally{o(!1)}},N=a=>{p(a),y(!1);try{a?localStorage.setItem("fp_selected_client",a.toString()):localStorage.removeItem("fp_selected_client")}catch(c){console.warn("Failed to save client selection to localStorage:",c)}t&&t(a),window.location.replace(window.location.href)},d=n.find(a=>a.id===r);return h?React.createElement("div",{className:"fp-client-selector loading"},"Caricamento..."):React.createElement("div",{className:"fp-client-selector",ref:b},React.createElement("button",{className:"client-selector-button",onClick:()=>y(!m),"aria-expanded":m},React.createElement("div",{className:"selected-client"},d?React.createElement(React.Fragment,null,d.logo_url?React.createElement("img",{src:d.logo_url,alt:d.name,className:"client-logo"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:d.color}},d.name.substring(0,2).toUpperCase()),React.createElement("span",{className:"client-name"},d.name)):React.createElement(React.Fragment,null,React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",{className:"client-name"},"Tutti i clienti")),React.createElement("span",{className:"dropdown-icon"},m?"\u25B2":"\u25BC"))),m&&React.createElement("div",{className:"client-dropdown"},React.createElement("div",{className:`dropdown-item ${r?"":"active"}`,onClick:()=>N(null)},React.createElement("span",{className:"client-badge",style:{backgroundColor:"#666"}},"ALL"),React.createElement("span",null,"Tutti i clienti"),!r&&React.createElement("span",{className:"check-icon"},"\u2713")),React.createElement("div",{className:"dropdown-divider"}),n.filter(a=>a.status==="active").map(a=>React.createElement("div",{key:a.id,className:`dropdown-item ${r===a.id?"active":""}`,onClick:()=>N(a.id)},a.logo_url?React.createElement("img",{src:a.logo_url,alt:a.name,className:"client-avatar"}):React.createElement("span",{className:"client-badge",style:{backgroundColor:a.color}},a.name.substring(0,2).toUpperCase()),React.createElement("span",null,a.name),r===a.id&&React.createElement("span",{className:"check-icon"},"\u2713"))),React.createElement("div",{className:"dropdown-divider"}),React.createElement("div",{className:"dropdown-item action-item",onClick:()=>{y(!1),window.location.href="/wp-admin/admin.php?page=fp-publisher-clients"}},React.createElement("span",{className:"icon"},"\u2699\uFE0F"),React.createElement("span",null,"Gestisci Clienti"))))};var ee=()=>{let n=new URLSearchParams(window.location.search).get("page")||"fp-publisher";return React.createElement("div",{className:"fp-publisher-app"},React.createElement("div",{className:"fp-app-header"},React.createElement("div",{className:"app-logo"},React.createElement("span",{className:"logo-icon"},"\u{1F680}"),React.createElement("span",{className:"logo-text"},"FP Publisher")),React.createElement(Z,null)),React.createElement("div",{className:"fp-app-content"},(()=>{switch(n){case"fp-publisher":case"fp-publisher-dashboard":return React.createElement(W,null);case"fp-publisher-composer":return React.createElement(J,null);case"fp-publisher-calendar":return React.createElement(G,null);case"fp-publisher-analytics":return React.createElement(Y,null);case"fp-publisher-library":return React.createElement(V,null);case"fp-publisher-clients":return React.createElement(q,null);case"fp-publisher-accounts":return React.createElement(Q,null);case"fp-publisher-jobs":return React.createElement(X,null);case"fp-publisher-settings":return React.createElement(K,null);default:return React.createElement(W,null)}})()))};var te=document.getElementById("fp-publisher-app");te&&(0,ae.render)(React.createElement(ee,null),te);})();
